/* Code Effects Software © 2021 | https://CodeEffects.com | 5.0.38.4 | January 18, 2021 */

window || (this.window = this); window.CodeEffects || (window.CodeEffects = { typeName: "CodeEffects", getName: function () { return "CodeEffects" }, __namespace: !0 }); CodeEffects.register || (CodeEffects.register = function (k) { var p = window; k = k.split("."); for (var d = 0; d < k.length; d++){ var n = k[d], m = p[n]; m || (m = p[n] = { typeName: k.slice(0, d + 1).join("."), __namespace: !0 }, m.getName = function () { return this.typeName }); p = m } }); CodeEffects.register("CodeEffects.Rule.Client"); CodeEffects.register("CodeEffects.Rule.Models"); CodeEffects.register("CodeEffects.Rule.Menu");
CodeEffects.register("CodeEffects.Rule.Calendar");CodeEffects.register("CodeEffects.Rule.Time");CodeEffects.register("CodeEffects.Rule.TextBox");CodeEffects.register("CodeEffects.Rule.Common");var $rule=CodeEffects.Rule;$rule.Models.RuleModel=function(){};$rule.Models.OperatorType={String:0,Numeric:1,Date:2,Time:3,Bool:4,Enum:6,Collection:8,None:16};$rule.Common.ValueInputType={Fields:0,User:2,All:4};$rule.Client.Element=function(){};$rule.Client.FunctionType={Name:0,Param:1,Comma:2,End:3,None:4};
$rule.Client.InputType={Field:0,Input:1,None:2};$rule.Client.CalculationType={Field:0,LeftParenthesis:1,RightParenthesis:2,Multiplication:3,Division:4,Addition:6,Subtraction:7,Number:8,None:9,Function:10};$rule.Client.CollectionType={Value:0,Reference:2,Generic:4,None:8};$rule.Client.SelectionType={Exists:0,DoesNotExist:1,None:2};
$rule.Client.ElementType={Flow:0,Field:1,Function:2,Operator:3,Value:4,Clause:6,Action:7,LeftParenthesis:8,RightParenthesis:9,LeftBracket:10,RightBracket:11,Calculation:12,Tab:13,NewLine:15,HtmlTag:16,Setter:17,LeftSource:18,RightSource:19,Where:20,Exists:22};$rule.Client.type={IE:0,Chrome:1,Firefox:2,Opera:3,Other:4};$rule.Client.browser=null;$rule.Client.version=Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject?11:0;
11==$rule.Client.version||navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("explorer")||-1<navigator.userAgent.indexOf(" MSIE ")?($rule.Client.browser=$rule.Client.type.IE,11!=$rule.Client.version&&($rule.Client.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]))):-1<navigator.userAgent.toLowerCase().indexOf(" firefox/")?$rule.Client.browser=$rule.Client.type.Firefox:-1<navigator.userAgent.toLowerCase().indexOf(" applewebkit/")?$rule.Client.browser=$rule.Client.type.Chrome:
navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("opera")||-1<navigator.userAgent.toLowerCase().indexOf("opera/")?$rule.Client.browser=$rule.Client.type.Opera:$rule.Client.browser=$rule.Client.type.Other;if($rule.Client.browser==$rule.Client.type.IE&&9>$rule.Client.version)throw Error("Your browser is not supported by Code Effects rules engine (CE482)");$rule.defined=function(k){return null!=k&&"undefined"!=typeof k&&"NaN"!=String(k)};
$rule.isNumeric=function(k){return!isNaN(parseFloat(k))&&isFinite(k)};$rule.isInteger=function(k){return $rule.isNumeric(k)&&0===k%1};$rule.text=function(k,p){if(!k.tagName)return null;if($rule.defined(p))$rule.defined(document.getElementsByTagName("BODY")[0].innerText)?k.innerText=p.toString():k.textContent=p.toString();else return $rule.defined(document.getElementsByTagName("BODY")[0].innerText)?k.innerText:k.textContent};
$rule.trim=function(k){return $rule.defined(k)&&0!==k.length?k.replace(/^\s+|\s+$/g,""):k};$rule.encode=function(k){return!$rule.defined(k)||1>k.length?k:String(k).replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/'/g,"&#39;")};
$rule.decode=function(k,p){if(!$rule.defined(k)||4>k.length)return k;var d=k;p||(d=String(d).replace(/&#92;/g,"\\").replace(/&quot;/g,'"'));return String(d).replace(/&#39;/g,"'").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")};$rule.highlight=function(k){k.style.backgroundColor="#ffff91"};$rule.dim=function(k){k.style.backgroundColor=""};
$rule.getElementWidth=function(k){return k.offsetWidth&&0<k.offsetWidth?k.offsetWidth:k.style.pixelWidth&&0<k.style.pixelWidth?k.style.pixelWidth:k.style.posWidth&&0<k.style.posWidth?k.style.posWidth:k.style.width&&0<k.style.width.length?parseInt(k.style.width.substr(0,k.style.width.length-2)):0};
$rule.getElementHeight=function(k){return $rule.defined(k.offsetHeight)&&0<k.offsetHeight?k.offsetHeight:$rule.defined(k.style.pixelHeight)&&0<k.style.pixelHeight?k.style.pixelHeight:$rule.defined(k.style.posHeight)&&0<k.style.posHeight?k.style.posHeight:$rule.defined(k.style.height)&&0<k.style.height.length?parseInt(k.style.height.substr(0,k.style.height.length-2),10):50};
$rule.getWindowDimensions=function(){var k=0,p=0;self.innerHeight?(k=window.innerHeight,p=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(k=document.documentElement.clientHeight,p=document.documentElement.clientWidth):document.body&&(k=document.body.clientHeight,p=document.body.clientWidth);return{height:parseInt(k,10),width:parseInt(p,10)}};
$rule.getScrollWidth=function(){var k=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;return k?k:0};$rule.getScrollHeight=function(){var k=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;return k?k:0};
$rule.position=function(k,p){var d=$rule.getBounds(k),n=$rule.getBounds(p),m=$rule.getWindowDimensions(),v=$rule.getScrollHeight(),u=$rule.getScrollWidth();p.style.top=m.height>d.y-v+d.height+n.height?d.y+d.height+"px":m.height-n.height+v-4+"px";p.style.left=m.width>d.x-u+d.width+n.width?d.x+d.width+6+"px":m.width-n.width+u-4+"px"};
$rule.leftAlign=function(k,p){var d=$rule.getBounds(k),n=$rule.getBounds(p),m=$rule.getWindowDimensions(),v=$rule.getScrollWidth();p.style.left=m.width>d.x-v+d.width+n.width?d.x+"px":m.width-n.width+v-4+"px"};$rule.getType=function(k){if(!$rule.defined(k.constructor))throw Error("CL1");k=String(k.constructor).match(/function\s+(\w+)/);return $rule.defined(k)?k[1]:"undefined"};$rule.getDocument=function(k){k=k.ownerDocument||k.document||k;return k.defaultView||k.parentWindow};
$rule.getStyle=function(k){if(3===k.nodeType)return null;var p=$rule.getDocument(k);k.documentElement&&(k=k.documentElement);var d=p&&k!==p&&p.getComputedStyle?p.getComputedStyle(k,null):k.currentStyle||k.style;if(!d&&$rule.Client.browser==$rule.Client.type.Chrome&&k.style){d=k.style.display;var n=k.style.position;k.style.position="absolute";k.style.display="block";p=p.getComputedStyle(k,null);k.style.display=d;k.style.position=n;d={};if(p)for(k=0;k<p.length;k++)d[k]=p[k];d.display="none"}return d};
$rule.getParentById=function(k,p){return $rule.defined(k)?k.id&&k.id==p?k:k.parentNode?$rule.getParentById(k.parentNode,p):null:null};$rule.getParentByTagName=function(k,p,d){$rule.defined(d)||(d=0);return 0<d&&k.tagName&&k.tagName==p?k:k.parentNode?$rule.getParentByTagName(k.parentNode,p,++d):null};
$rule.getChildrenByTagName=function(k,p,d){var n=[];if(k.childNodes)for(var m=0;m<k.childNodes.length;m++){var v=k.childNodes[m];v.tagName&&v.tagName==p&&n.push(v);if(d&&v.childNodes&&0<v.childNodes.length){v=$rule.getChildrenByTagName(v,p,d);for(var u=0;u<v.length;u++)n.push(v[u])}}return n};
$rule.getChildrenByAttribute=function(k,p,d){var n=[];if(k.childNodes)for(var m=0;m<k.childNodes.length;m++){var v=k.childNodes[m];if(v.tagName&&v.getAttribute){var u=v.getAttribute(p);!u||$rule.defined(d)&&u!=d||n.push(v)}if(v.childNodes&&0<v.childNodes.length)for(v=$rule.getChildrenByAttribute(v,p,d),u=0;u<v.length;u++)n.push(v[u])}return n};
$rule.StringBuilder=function(){var k=[];this.append=function(p){p=$rule.defined(p)?$rule.getType(p)!=$rule.getType(new String)?String(p):p:"";0<p.length&&(k[k.length]=p)};this.dump=function(){return k.join("")}};$rule.Point=function(k,p){this.x=k;this.y=p};
switch($rule.Client.browser){case $rule.Client.type.Chrome:$rule.getPosition=function(k){if(k.window&&k.window===k||9===k.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=null,m,v=k;v;n=m,v=v.offsetParent){m=$rule.getStyle(v);var u=v.tagName?v.tagName.toUpperCase():null;!v.offsetLeft&&!v.offsetTop||"BODY"===u&&n&&"absolute"===n.position||(p+=v.offsetLeft,d+=v.offsetTop)}m=(m=$rule.getStyle(k))?m.position:null;if(!m||"absolute"!==m)for(k=k.parentNode;k&&(u=k.tagName?k.tagName.toUpperCase():null,
"BODY"!==u&&"HTML"!==u&&(k.scrollLeft||k.scrollTop)&&(p-=k.scrollLeft||0,d-=k.scrollTop||0),!(m=(m=$rule.getStyle(k))?m.position:null)||"absolute"!==m);k=k.parentNode);return new $rule.Point(p,d)};break;case $rule.Client.type.Opera:$rule.getPosition=function(k){if(k.window&&k.window===k||9===k.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=k;n;n=n.offsetParent)p+=n.offsetLeft||0,d+=n.offsetTop||0;n=(n=k.style.position)&&"static"!==n;for(k=k.parentNode;k;k=k.parentNode){var m=k.tagName?k.tagName.toUpperCase():
null;"BODY"===m||"HTML"===m||!k.scrollLeft&&!k.scrollTop||!n||"scroll"!==k.style.overflow&&"auto"!==k.style.overflow||(p-=k.scrollLeft||0,d-=k.scrollTop||0);m=k&&k.style?k.style.position:null;n=n||m&&"static"!==m}return new $rule.Point(p,d)};break;case $rule.Client.type.Firefox:$rule.getPosition=function(k){if(k.window&&k.window===k||9===k.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=null,m=null,v,u=k;u;n=u,m=v,u=u.offsetParent){var Q=u.tagName?u.tagName.toUpperCase():null;v=$rule.getStyle(u);
(u.offsetLeft||u.offsetTop)&&("BODY"!==Q||m&&"absolute"===m.position)&&(p+=u.offsetLeft,d+=u.offsetTop);null!==n&&v&&("TABLE"!==Q&&"TD"!==Q&&"HTML"!==Q&&(p+=parseInt(v.borderLeftWidth)||0,d+=parseInt(v.borderTopWidth)||0),"TABLE"!==Q||"relative"!==v.position&&"absolute"!==v.position||(p+=parseInt(v.marginLeft)||0,d+=parseInt(v.marginTop)||0))}v=(v=$rule.getStyle(k))?v.position:null;if(!v||"absolute"!==v)for(k=k.parentNode;k;k=k.parentNode)if(Q=k.tagName?k.tagName.toUpperCase():null,"BODY"!==Q&&"HTML"!==
Q&&(k.scrollLeft||k.scrollTop)&&(p-=k.scrollLeft||0,d-=k.scrollTop||0,v=$rule.getStyle(k)))p+=parseInt(v.borderLeftWidth)||0,d+=parseInt(v.borderTopWidth)||0;return new $rule.Point(p,d)};break;default:$rule.getPosition=function(k){if(k.self||9===k.nodeType)return new $rule.Point(0,0);var p={bottom:0,height:0,left:0,right:0,top:0,width:0};try{p=k.getBoundingClientRect()}catch(u){}if(!p)return new $rule.Point(0,0);var d=k.ownerDocument.documentElement,n=p.left-2+d.scrollLeft;p=p.top-2+d.scrollTop;try{var m=
k.ownerDocument.parentWindow.frameElement||null;if(m){var v="0"===m.frameBorder||"no"===m.frameBorder?2:0;n+=v;p+=v}}catch(u){}return new $rule.Point(n,p)}}$rule.getBounds=function(k){var p=$rule.getPosition(k);return{x:p.x,y:p.y,width:$rule.getElementWidth(k),height:$rule.getElementHeight(k)}};
$rule.topZindex=function(k,p){p=p||1;if(k.childNodes)for(var d=0,n,m=k.childNodes.length;d<m;d++)n=k.childNodes[d],n.tagName&&n.style&&$rule.isInteger(n.style.zIndex)&&n.style.zIndex>p&&(p=n.style.zIndex+1),0<n.childNodes.length&&(p=$rule.topZindex(n,p));return p};
$rule.Json=function(){this.serialize=function(p){var d=new $rule.StringBuilder;k(p,d,!1);return d.dump()};this.deserialize=function(p){if(!$rule.defined(p)||0==p.length)throw Error("CL2");try{return eval("("+p.replace(/\\"/g,'"')+")")}catch(d){throw Error("CL41");}};var k=function(p,d){var n;switch(typeof p){case "number":isFinite(p)?d.append(p.toString()):d.append("null");break;case "string":d.append('"');d.append(p);d.append('"');break;case "boolean":d.append(p.toString());break;case "object":if($rule.defined(p))if($rule.getType(p)==
$rule.getType([])){d.append("[");for(n=0;n<p.length;++n)0<n&&d.append(","),k(p[n],d);d.append("]")}else{var m=[],v=0;for(n in p)m[v++]=n;d.append("{");var u=!1;for(n=0;n<v;n++){var Q=p[m[n]];$rule.defined(Q)&&"function"!==typeof Q&&(u?d.append(","):u=!0,k(m[n],d),d.append(":"),k(Q,d))}d.append("}")}else d.append("null");break;default:d.append("null")}}};
$rule.formatDate=function(k,p){function d(q){return 10>q?"0"+q:q.toString()}function n(q,w){for(var c=0,F=!1,W=0,P=q.length;W<P;W++){var Z=q.charAt(W);switch(Z){case "'":F?w.append("'"):c++;F=!1;break;case "\\":F&&w.append("\\");F=!F;break;default:w.append(Z),F=!1}}return c}function m(q){return 10>q?"00"+q:100>q?"0"+q:q.toString()}if(!p||0===p.length||"i"===p)return k.toString();p=function(q){$rule.defined(q)||(q="d");if(1==q.length)switch(q){case "F":return"dddd, MMMM dd, yyyy h:mm:ss tt";case "s":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss";
case "Y":case "y":return"MMMM, yyyy";case "M":case "m":return"MMMM dd";case "d":return"M/d/yyyy";case "D":return"dddd, MMMM dd, yyyy";case "t":return"h:mm tt";case "T":return"h:mm:ss tt";default:throw Error("CL61");}return q}(p);for(var v=new $rule.StringBuilder,u,Q=0,H=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;;){var N=H.lastIndex;u=H.exec(p);N=p.slice(N,u?u.index:p.length);N=n(N,v);Q+=N;if(!u)break;if(1===Q%2)v.append(u[0]);else switch(u[0]){case "MMMM":v.append($rule.monthNames[k.getMonth()]);
break;case "MMM":v.append($rule.abbrMonthNames[k.getMonth()]);break;case "MM":v.append(d(k.getMonth()+1));break;case "M":v.append(k.getMonth()+1);break;case "dddd":v.append($rule.dayNames[k.getDay()]);break;case "ddd":v.append($rule.abbrDayNames[k.getDay()]);break;case "dd":v.append(d(k.getDate()));break;case "d":v.append(k.getDate());break;case "yyyy":v.append(k.getFullYear());break;case "yy":v.append(d(k.getFullYear()%100));break;case "y":v.append(k.getFullYear()%100);break;case "hh":u=k.getHours()%
12;0===u&&(u=12);v.append(d(u));break;case "h":u=k.getHours()%12;0===u&&(u=12);v.append(u);break;case "HH":v.append(d(k.getHours()));break;case "H":v.append(k.getHours());break;case "mm":v.append(d(k.getMinutes()));break;case "m":v.append(k.getMinutes());break;case "ss":v.append(d(k.getSeconds()));break;case "s":v.append(k.getSeconds());break;case "tt":v.append(12>k.getHours()?"AM":"PM");break;case "t":v.append(12>k.getHours()?"A":"P");break;case "f":v.append(m(k.getMilliseconds()).charAt(0));break;
case "ff":v.append(m(k.getMilliseconds()).substr(0,2));break;case "fff":v.append(m(k.getMilliseconds()));break;case "z":u=k.getTimezoneOffset()/60;v.append((0>=u?"+":"-")+Math.floor(Math.abs(u)));break;case "zz":u=k.getTimezoneOffset()/60;v.append((0>=u?"+":"-")+d(Math.floor(Math.abs(u))));break;case "zzz":u=k.getTimezoneOffset()/60,v.append((0>=u?"+":"-")+d(Math.floor(Math.abs(u)))+":"+d(Math.abs(k.getTimezoneOffset()%60)))}}return v.dump()};
Function.addDelegate=function(k,p){return function(){return p.apply(k,arguments)}};
$rule.Event=function(k){k=k||window.event;var p=this.type=k.type.toLowerCase();this.rawEvent=k;"keypress"==p&&(this.charCode=k.charCode||k.keyCode);k.keyCode?this.keyCode=46==k.keyCode&&"keypress"!=p?127:k.keyCode:k.charCode?this.keyCode=k.charCode:"undefined"!=typeof k.which&&(this.keyCode=k.which);this.offsetY=k.pageY?k.pageY:k.clientY+document.body.scrollTop-document.body.clientTop;this.target=k.target?k.target:k.srcElement;this.ctrlKey=k.ctrlKey;this.metaKey=k.metaKey||!1;this.altKey=k.altKey;
this.shiftKey=k.shiftKey;this.changedTouches=k.changedTouches||null};$rule.Event.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}};
$rule.addHandler=function(k,p,d){k.ceEvents||(k.ceEvents={});var n=k.ceEvents[p];n||(k.ceEvents[p]=n=[]);if(k.addEventListener){var m=function(v){return d.call(k,new $rule.Event(v))};k.addEventListener(p,m,!1)}else k.attachEvent&&(m=function(){var v={};try{v=$rule.getDocument(k).event}catch(u){}return d.call(k,new $rule.Event(v))},k.attachEvent("on"+p,m));n[n.length]={handler:d,browserHandler:m}};
$rule.addHandlers=function(k,p,d){for(var n in p){var m=p[n];d&&(m=Function.addDelegate(d,m));$rule.addHandler(k,n,m)}};$rule.removeHandlers=function(k){if(k.ceEvents){var p;for(p in k.ceEvents)if(k.ceEvents.hasOwnProperty(p)){var d=k.ceEvents[p];if(d.length&&0<d.length)for(var n=0,m,v=d.length;n<v;n++)m=d[n],m.browserHandler&&(k.removeEventListener?k.removeEventListener(p,m.browserHandler):k.detachEvent&&k.detachEvent(p,m.browserHandler));delete k.ceEvents[p]}delete k.ceEvents}};
$rule.Context={controls:[],addControl:function(k,p){for(var d=0,n=$rule.Context.controls.length;d<n;d++)if($rule.Context.controls[d].id==k)throw Error("Rule Editor with specified ID already exist in the current context (CL85)");$rule.Context.controls.push(new $rule.Context.Item(k,p))},getControl:function(k){for(var p=0,d=$rule.Context.controls.length;p<d;p++)if($rule.Context.controls[p].id==k)return $rule.Context.controls[p].ref;return null},removeControl:function(k){for(var p=[],d=0,n,m=$rule.Context.controls.length;d<
m;d++)n=$rule.Context.controls[d],n.id!=k&&p.push(n);0<p.length&&($rule.Context.controls=p)},clear:function(){$rule.Context.controls=[]}};$rule.Context.Item=function(k,p){this.id=k;this.ref=p};var $ce=$rule.Context.getControl;$rule.Menu.Item=function(){this.Type=this.Name=this.ID=null};
$rule.Menu.Control=function(k,p){var d=$rule,n,m,v,u,Q,H,N=null,q=!1,w=[],c=d.highlight,F=d.dim,W=d.getElementHeight,P=d.defined,Z=d.Client.browser==d.Client.type.Opera;this.init=function(ea,R){N=ea;Q=R;w=[];Z?d.addHandlers(document,{keydown:y,keypress:S},N):d.addHandlers(document,{keydown:y},N)};this.close=function(){P(n)&&P(n.parentNode)&&n.parentNode.removeChild(n);q=!1;w=[];Q&&Q()};this.select=function(ea){if(n)for(var R=$rule.getChildrenByTagName(n,"DIV",!1),pa=0;pa<R.length;pa++)if(0===R[pa].innerHTML.toLowerCase().lastIndexOf(ea.toLowerCase(),
0)){ta(R[pa]);break}};this.fill=function(ea,R,pa,Ma,kb){if(P(R)&&0!=R.length){q=!0;v=pa;u=kb;H=Ma;ua(ea);w=[];m=-1;pa=0;for(var K;pa<R.length;pa++)Ma=R[pa],K=document.createElement("DIV"),K.id="ce104"+ea.id+pa,K.innerHTML=Ma.Name,n.appendChild(K),w.push(K),K.setAttribute("ce101",P(Ma.ID)?Ma.ID:""),K.setAttribute("ce102",P(Ma.Type)?Ma.Type:""),K.setAttribute("ce103",pa),K.onclick=function(J){J=J||window.event;J.cancelBubble=!0;v&&v(this.getAttribute("ce101"),this.getAttribute("ce102"),this.innerHTML)},
K.onmouseover=function(J){ta(this);u&&u(this.getAttribute("ce101"))},K.onmouseout=function(J){F(this)};12<R.length&&(R=W(K),P(R)&&0!=R||(R=22),n.style.height=12*R+"px");d.position(ea,n);n.onclick=function(J){J=J||window.event;J.cancelBubble=!0;return!1}}else w=[]};this.alignLeft=function(ea){P(n)&&P(ea)&&d.leftAlign(ea,n)};var y=function(ea){var R=ea.keyCode;if(!q||!P(n)||0==w.length)return!0;switch(R){case 13:-1<m?v&&v(w[m].getAttribute("ce101"),w[m].getAttribute("ce102"),w[m].innerHTML):H&&H();
break;case 32:-1<m&&v&&v(w[m].getAttribute("ce101"),w[m].getAttribute("ce102"),w[m].innerHTML);break;case 38:-1==m&&(m=0);if(0<=m){var pa=w[m].offsetTop-n.scrollTop<w[0].clientHeight;m--;0>m&&(m=0);pa&&(n.scrollTop=w[m].offsetTop);ia(w)}break;case 40:pa=w[0].clientHeight,pa=n.scrollTop+11*pa-m*pa<pa,m++,m>w.length-1&&(m=w.length-1),pa&&(n.scrollTop=w[m-12+1].offsetTop),ia(w)}Z||8!=R&&9!=R&&13!=R&&32!=R&&33!=R&&34!=R&&35!=R&&36!=R&&38!=R&&40!=R||(ea.preventDefault&&ea.preventDefault(),ea.stopPropagation&&
ea.stopPropagation())},S=function(ea){if(q&&P(n)&&0!=w.length){var R=ea.keyCode;8!=R&&9!=R&&13!=R&&32!=R&&33!=R&&34!=R&&35!=R&&36!=R&&38!=R&&40!=R||ea.preventDefault();return!1}return!0},ia=function(){Db();0!=w.length&&(c(w[m]),u&&u(w[m].getAttribute("ce101")))},ta=function(ea){m=parseInt(ea.getAttribute("ce103"),10);Db();c(ea)},ua=function(ea){n=document.createElement("DIV");n.id="ce107"+ea.id;n.style.backgroundColor="#fff";P(k)&&(n.className=k);n.style.position="absolute";n.style.padding="2px";
n.style.overflow="auto";n.style.display="inline-block";p&&(n.style.zIndex=$rule.topZindex(document.body));document.body.appendChild(n)},Db=function(){for(var ea=0;ea<w.length;ea++)F(w[ea])}};$rule.Time.Settings=function(k){this.us=-1<k.indexOf("t");this.h=-1<k.indexOf("h")||-1<k.indexOf("H");this.m=-1<k.indexOf("m");this.s=-1<k.indexOf("s");this.dp=this.h||this.m||this.s};
$rule.Time.Picker=function(k,p){var d=$rule,n=null,m,v,u,Q,H,N=!1,q=new Date;var w=q.getHours();var c=q.getMinutes();var F=q.getSeconds();this.defaultFormat=function(){return n?n.defaultFormat():"hh:mm tt"};this.show=function(y,S,ia,ta,ua){Q=y;u=S;H=d.defined(ia)?ia:"hh:mm tt";N=ta;d.defined(ua)&&(w=ua.getHours(),c=ua.getMinutes(),F=ua.getSeconds());W();Z()};this.hide=function(){d.defined(m)&&d.defined(m.parentNode)&&m.parentNode.removeChild(m)};this.position=function(){Z()};this.getId=function(){return d.defined(m)?
m.id:null};var W=function(){m=document.createElement("TABLE");m.id="ce110"+Q.id;m.insertRow(-1).insertCell(-1);d.defined(k)&&(m.className=k);m.cellSpacing=0;m.cellPadding=2;m.style.position="absolute";p&&(m.style.zIndex=$rule.topZindex(document.body));v=document.createElement("TABLE");v.id="ce111"+Q.id;v.setAttribute("ce108","true");v.cellSpacing=0;v.cellPadding=2;var y=v.insertRow(-1).insertCell(-1);y.style.padding="2px 6px";n=new d.Time.Control(y,H,P);n.setValue(w,c,F);m.rows[0].cells[0].appendChild(v);
document.body.appendChild(m);m.onclick=function(S){S=S||window.event;S.cancelBubble=!0;return!1}},P=function(){q=n.getRawValue();w=q.getHours();c=q.getMinutes();F=q.getSeconds();d.defined(u)&&u(n.getValue(),n.getText())},Z=function(){d.defined(Q)&&(d.position(Q,m),N&&d.leftAlign(Q,m))}};
$rule.Time.Control=function(k,p,d){function n(y,S,ia){if(H.defined(y)&&H.defined(y.options)&&0!=y.options.length){for(var ta=!1,ua=0;ua<y.options.length;ua++)if(!ia&&y.options[ua].text==S||ia&&y.options[ua].value==S){y.selectedIndex=ua;ta=!0;break}ta||(y.selectedIndex=0)}}function m(y){return H.defined(y)&&H.defined(y.options)&&-1!=y.selectedIndex?y.options[y.selectedIndex].value:null}function v(y){return H.defined(y)&&H.defined(y.options)&&-1!=y.selectedIndex?y.options[y.selectedIndex].text:null}
function u(y,S,ia){var ta=document.createElement("OPTION");ta.text=S;ta.value=ia;H.Client.browser==H.Client.type.IE?y.options.add(ta):y.appendChild(ta)}function Q(y,S,ia,ta){for(--S;S<ia;S++){var ua=S+1;u(y,ta&&10>ua?"0"+ua:ua,ua)}}var H=$rule;p=H.defined(p)?p:"hh:mm tt";var N=new H.Time.Settings(p),q=function(){if(!N.h)return 0;if(N.us){var y=parseInt(m(F),10);return"AM"==m(Z)?12==y?0:y:12==y?y:y+12}return parseInt(m(F),10)},w=function(y){var S=document.createElement("SELECT");S.id=y;S.style.width=
"44px";k.appendChild(S);Q(S,0,59,!0);return S},c=function(){var y=document.createElement("SPAN");y.innerHTML="<b>:</b>";y.style.marginLeft="2px";y.style.marginRight="2px";k.appendChild(y)},F=null,W=null,P=null,Z=null;N.h&&(F=document.createElement("SELECT"),F.id="ce113"+k.id,F.style.width="44px",k.appendChild(F),N.us?(u(F,"12",12),Q(F,1,11,!1)):Q(F,0,23,!0));N.h&&N.m&&c();N.m&&(W=w("ce114"+k.id));N.s&&(c(),P=w("ce115"+k.id));N.h&&N.us&&(Z=document.createElement("SELECT"),Z.id="ce116"+k.id,Z.style.width=
"44px",Z.style.marginLeft="4px",k.appendChild(Z),u(Z,"AM","AM"),u(Z,"PM","PM"));(function(){var y=document.createElement("INPUT");y.id="ce112"+k.id;y.type="button";y.style.marginLeft="4px";y.value="OK";k.appendChild(y);y.onclick=function(S){S=S||window.event;S.cancelBubble=!0;d()}})();this.defaultFormat=function(){return"hh:mm tt"};this.getRawValue=function(){return new Date("1/1/2000 "+q()+":"+(N.m?v(W):"00")+":"+(N.s?v(P):"00"))};this.getValue=function(){return H.formatDate(this.getRawValue(),"HH:mm:ss")};
this.getText=function(){var y=(N.h?v(F):"00")+":"+(N.m?v(W):"00")+":"+(N.s?v(P):"00")+(N.h&&N.us?" "+v(Z):"");return H.formatDate(new Date("1/1/2000 "+y),p)};this.setValue=function(y,S,ia){if(H.defined(y)&&H.defined(S)&&H.defined(ia)&&0!=y.length&&0!=S.length&&0!=ia.length){if(N.h)if(N.us){y=parseInt(y,10);var ta=y-12;13>y?(ta=0==y?12:y,n(Z,"AM",!0)):n(Z,"PM",!0);n(F,ta,!0)}else 2>y.length?n(F,y,!0):n(F,y,!1);N.m&&(2>S.length?n(W,S,!0):n(W,S,!1));N.s&&(2>ia.length?n(P,ia,!0):n(P,ia,!1))}else N.h&&
(F.selectedIndex=0),N.m&&(W.selectedIndex=0),N.s&&(P.selectedIndex=0),N.h&&N.us&&(Z.selectedIndex=0)}};$rule.TextBox.Settings=function(k,p,d,n,m,v,u,Q){this.parent=k;this.id=p;this.css=d;this.defCss=n;this.max=m;this.placeholder=v;this.errVal=u;this.errColor=Q};
$rule.TextBox.Control=function(){var k,p;this.init=function(d){p=d;k=document.createElement("INPUT");k.type="text";k.id=p.id;k.className=p.defCss;k.maxLength=p.max;k.placeholder=p.placeholder;p.parent.appendChild(k);k.onfocus=function(n){k.className=$rule.trim(k.className.replace(p.errColor,""));k.className=p.css;k.value.toLowerCase()==p.errVal.toLowerCase()&&(k.value="")};k.onblur=function(n){n=$rule.trim(k.value);if(0==n.length||n.toLowerCase()==p.errVal.toLowerCase())k.className=$rule.trim(k.className.replace(p.errColor,
"")),k.className=p.defCss}};this.getValue=function(){return k.value};this.setValue=function(d){k.value=d};this.setClass=function(d){k.className=d}};$rule.Calendar.Css=function(){this.container="ceCal";this.header="ceHeader";this.day="ceDay";this.today="ceToday";this.selected="ceSelected";this.dayRollover="ceRollover";this.weekDays="ceDays"};
$rule.Calendar.Control=function(k,p){var d=$rule,n,m,v,u,Q=!1,H=d.defined(p)?p:new d.Calendar.Css,N,q,w,c,F=new Date;var W=F.getMonth();var P=F.getFullYear();var Z=F.getHours();var y=F.getMinutes();var S=F.getSeconds();var ia=F.getDate();var ta=N=0;this.show=function(K,J,M,T,X){n=K;v=J;u=d.defined(M)?M:"MMM dd, yyyy";Q=T;d.defined(X)&&(ia=X.getDate(),N=P=X.getFullYear(),ta=W=X.getMonth(),Z=X.getHours(),y=X.getMinutes(),S=X.getSeconds());R();kb();ua()};this.hide=function(){d.defined(c)&&d.defined(c.parentNode)&&
c.parentNode.removeChild(c)};this.position=function(){kb()};this.defaultFormat=function(){return"MMM dd, yyyy"};this.getId=function(){return d.defined(c)?c.id:null};var ua=function(){var K=d.getChildrenByTagName(q.rows[0].cells[1],"SPAN",!1);K[0].innerHTML=d.abbrMonthNames[W];K[1].innerHTML=P;Db()},Db=function(){var K=new Date,J=new Date(P,W,1),M=K.getFullYear(),T=K.getMonth();K=K.getDate();J=J.getDay();var X=1,Qa=!0;var ub=1==W&&(0==P%4&&0!=P%100||0==P%400)?29:d.days[W];for(var ma=1;ma<w.rows.length;ma++)for(var Ca=
0;Ca<w.rows[ma].cells.length;Ca++){var ja=w.rows[ma].cells[Ca];Qa=!0;1==ma&&Ca>=J||1<ma&&X<=ub?(ja.innerHTML=X,M==P&&T==W&&X==K&&d.defined(H.today)?(ja.className=H.today,ja.setAttribute("ce117",H.today),Qa=!1):P==N&&W==ta&&X==ia&&d.defined(H.selected)?(ja.className=H.selected,ja.setAttribute("ce117",H.selected),Qa=!1):d.defined(H.day)&&(ja.className=H.day),Qa&&d.defined(H.day)&&ja.setAttribute("ce117",H.day),ja.onclick=function(ka){var Xa=(new d.Time.Settings(u)).dp;Xa||(ka=ka||window.event,ka.cancelBubble=
!0);for(var Eb=1;Eb<w.rows.length;Eb++)for(var Fb=0;Fb<w.rows[Eb].cells.length;Fb++)ka=w.rows[Eb].cells[Fb],ka.getAttribute("ce117")==H.today?ka.className=H.today:(ka.className=H.day,ka.setAttribute("ce117",H.day));ia=parseInt(d.text(this),10);this.className!=H.today&&d.defined(H.selected)&&(this.className=H.selected,this.setAttribute("ce117",H.selected));Xa||ea()},ja.onmouseover=function(ka){d.defined(H.dayRollover)&&(this.className=H.dayRollover)},ja.onmouseout=function(ka){ka=this.getAttribute("ce117");
d.defined(ka)&&(this.className=ka)},X++):(d.defined(H.day)&&(ja.className=H.day),ja.innerHTML="&nbsp;",ja.onclick=ja.onmouseover=ja.onmouseout=null)}},ea=function(){var K=W+1+"/"+ia+"/"+P;F=new Date(K);W=F.getMonth();P=F.getFullYear();ia=F.getDate();ta=W;N=P;if((new d.Time.Settings(u)).dp){var J=m.getRawValue();Z=J.getHours();y=J.getMinutes();S=J.getSeconds();K+=" "+Z+":"+y+":"+S}d.defined(v)&&v(K)},R=function(){c=document.createElement("TABLE");c.id="ce120"+n.id;c.setAttribute("ceCalendarControl",
"true");c.cellSpacing=0;c.cellPadding=1;var K=c.insertRow(-1);K=K.insertCell(-1);d.defined(H.container)&&(c.className=H.container);c.style.position="absolute";k&&(c.style.zIndex=$rule.topZindex(document.body));q=document.createElement("TABLE");q.id="ce121"+n.id;q.setAttribute("ce118","true");d.defined(H.header)&&(q.className=H.header);q.cellSpacing=q.cellPadding=0;q.style.width="100%";var J=q.insertRow(-1),M=J.insertCell(-1);M.style.padding="3px 0px 5px 6px";var T=Ma(M,"ce123"+n.id,"&#171;&#171;");
T.style.marginRight="4px";T.onclick=function(X){X=X||window.event;X.cancelBubble=!0;--P;ua()};M=Ma(M,"ce124"+n.id,"&#171;");M.style.marginLeft="2px";M.onclick=function(X){X=X||window.event;X.cancelBubble=!0;0==W?(W=11,--P):--W;ua()};T.style.cursor=M.style.cursor="pointer";M=J.insertCell(-1);M.style.width="90px";M.style.textAlign="center";M.style.padding="3px 0px 5px 0px";T=Ma(M,"ce125"+n.id,d.abbrMonthNames[W]);M=Ma(M,"ce126"+n.id,P);T.style.marginRight="2px";M.style.marginLeft="2px";T.style.cursor=
M.style.cursor="default";T=J.insertCell(-1);T.style.padding="3px 6px 5px 0px";T.style.textAlign="right";J=Ma(T,"ce127"+n.id,"&#187;");J.style.marginRight="2px";J.onclick=function(X){X=X||window.event;X.cancelBubble=!0;11==W?(W=0,++P):++W;ua()};T=Ma(T,"ce128"+n.id,"&#187;&#187;");T.style.marginLeft="4px";T.onclick=function(X){X=X||window.event;X.cancelBubble=!0;++P;ua()};T.style.cursor=J.style.cursor="pointer";K.appendChild(q);w=pa();document.body.appendChild(c);(new d.Time.Settings(u)).dp&&(K=c.insertRow(-1),
K=K.insertCell(-1),K.style.padding="0 4px 6px 4px",K.style.textAlign="center",m=new d.Time.Control(K,u,ea),m.setValue(Z,y,S))},pa=function(){var K=document.createElement("TABLE");K.id="ce148"+n.id;K.cellSpacing=1;K.cellPadding=0;K.style.width="100%";for(var J,M,T=0;7>T;T++){J=K.insertRow(-1);for(var X=0;7>X;X++)M=J.insertCell(-1),0==T&&d.defined(H.weekDays)&&(M.className=H.weekDays),M.innerHTML="&nbsp;"}for(J=0;J<K.rows[0].cells.length;J++)K.rows[0].cells[J].innerHTML=d.abbrWeekDayNames[J];c.rows[0].cells[0].appendChild(K);
return K},Ma=function(K,J,M){var T=document.createElement("SPAN");d.defined(J)&&(T.id=J);T.innerHTML=M;K.appendChild(T);return T},kb=function(){d.defined(n)&&(d.position(n,c),Q&&d.leftAlign(n,c))}};$rule.days=[31,28,31,30,31,30,31,31,30,31,30,31];$rule.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");$rule.abbrDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" ");$rule.abbrWeekDayNames="SMTWTFS".split("");$rule.monthNames="January February March April May June July August September October November December ".split(" ");
$rule.abbrMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ");$rule.init=function(k){data=(new $rule.Json).deserialize(k&&k.d||k);$rule.defined(data.h)&&($rule.Help=data.h);$rule.Errors=data.e;$rule.Context.addControl(data.id,new $rule.Control({element:data.id,asp:!1,z:data.z}));return $ce(data.id)};
$rule.Settings=function(k){this.help=k.ui[0];this.isEval=k.ui[1];this.evalIf=k.ui[2];this.execIf=k.ui[3];this.tools=k.ui[4];this.pb=k.ui[5];this.tochki=k.ui[6];this.clicks=k.ui[7];this.titles=k.ui[8];this.right=k.ui[9];this.mode=k.ui[10];this.tId=k.ui[11];this.tUrl=k.ui[12];this.tCoId=k.ui[13];this.tCoUrl=k.ui[14];this.els=k.s;this.clientFlds=[]};
$rule.Control=function(k){var p=$rule,d,n,m,v,u,Q,H,N,q=null,w,c=null,F=null,W=[],P=[],Z=[],y,S=[],ia=null,ta=null,ua=null,Db,ea,R,pa,Ma,kb,K=null,J,M,T,X,Qa,ub=null,ma=!0,Ca,ja,ka=null,Xa=0,Eb=!1,Fb=!1,Fa=null,vb=!1,Ga=null,Za=!1,fa=!1,Da=!1,Y=!1,wb=!1,Na=0,sc=0,tc=0,ba=this,h=p.defined,Gb=new p.Json,gb,uc,bc,Yc=p.getChildrenByAttribute,z=null,cc,Xb,Yb,vc=!1,wc=!1,Hb=null,xc=null,yc=null,zc=null;if(!h(k))throw Error("Params object is expected (CL242)");var C={clientOnly:!1,container:null,form:null,
field:null,id:"ceDefaultID",asp:k.asp||!1,useZindex:k.z||!1,fieldId:k.h||null};if(h(k.element))if("string"===typeof k.element)C.id=k.element;else{if("object"!==typeof k.element)throw Error("Invalid value of the main container (CL246)");C.container=k.element;if(h(k.element.id)&&0<$rule.trim(k.element.id).length)C.id=k.element.id;else throw Error("The editor's container must have id (CL246)");}else throw Error("Pars.element value must be either a DOM element or its id (CL244)");ba.loadSettings=function(a){cc=
a&&a.d||a;Zc();return ba};ba.loadRule=function(a){Yb=a&&a.d||a;if(h(Yb))return Ac(),ba};ba.loadInvalids=function(a){Xb=a&&a.d||a;if(h(Xb))return Bc(),ba};ba.setClientActions=function(a,b,e){xc=e;yc=b;zc=a;return ba};ba.getRuleId=function(){return Fa};ba.isEvaluationType=function(){return q?q.isEval:!0};ba.saved=function(a){function b(x,r){return x.Name.localeCompare(r.Name)}function e(x,r){return x.n.localeCompare(r.n)}if(!C.clientOnly)return ba;h(a)&&(Fa=a);h(Fa)&&Fa!=a&&$c();var g=[],l=!1;if(q.tools){for(var t=
0;t<Z.length;t++)a=Z[t],"ceEval"!=a.ID&&"ceExec"!=a.ID&&(a.ID==Fa&&(a.Name=Qb(T.getValue()),l=!0),g.push({ID:a.ID,Name:a.Name}));l||(a=new p.Menu.Item,a.ID=Fa,a.Name=Qb(T.getValue()),g.push(a));g.sort(b);q.els.rls=g;ad()}if(q.isEval){l=!1;for(g=0;g<z.fds.length;g++)if(a=z.fds[g],a.ir&&a.v==Fa){a.n=Qb(T.getValue());l=!0;break}l||(a={n:Qb(T.getValue()),v:Fa,o:4,t:1,ai:2,ir:!0,l:!1},z.fds.push(a));z.fds.sort(e)}return ba};ba.deleted=function(a){for(var b=[],e,g=0;g<Z.length;g++)e=Z[g],e.ID!=a&&b.push(e);
Z=b;if(q.isEval){b=[];for(g=0;g<z.fds.length;g++)e=z.fds[g],e.v!=a&&b.push(e);z.fds=b}return ba};ba.isAltered=function(){return wb};ba.isEmpty=function(a){a=void 0===a?!0:a;for(var b=$a(),e=0;e<b.length;e++)switch(D(b[e])){case d.Flow:case d.Field:case d.Function:case d.Operator:case d.Value:case d.Clause:case d.Action:case d.LeftParenthesis:case d.RightParenthesis:case d.LeftBracket:case d.RightBracket:case d.Calculation:case d.Setter:case d.LeftSource:case d.RightSource:case d.Where:case d.Exists:return!1;
case d.Tab:case d.NewLine:case d.HtmlTag:if(a)return!1}return!0};ba.extract=function(){Hb="ceExtract";vb=!1;return Gb.serialize(dc())};ba.clear=function(){bd();wb=!1;return ba};ba.dispose=function(){Rb();ec("ceMenu");ec("ceTime");p.removeHandlers(window);p.removeHandlers(document);h(C.form)&&p.removeHandlers(C.form);if(h(C.container)&&!h(C.form)){var a=p.getChildrenByAttribute(document.body,"ce","form"+C.container.id);if(h(a)&&0<a.length)try{var b=a[0];document.body.removeChild(b);var e=document.getElementById(C.fieldId);
h(e)&&b.removeChild(e)}catch(g){}}return ba};ba.redraw=function(){cd();return ba};ba.disable=function(){Rb();w=9;return ba};ba.enable=function(){Rb();return ba};ba.init=function(a){cc=a;p.addHandlers(window,{load:Zc},ba)};ba.load=function(a){h(a)&&(Yb=a,p.addHandlers(window,{load:Ac},ba))};ba.invalid=function(a){h(a)&&(Xb=a,p.addHandlers(window,{load:Bc},ba))};ba.valid=function(){Cc();Ra()};ba.post=function(){Dc()};var Zc=function(){q=new $rule.Settings(Gb.deserialize(cc));cc=null;if(!h(q.els.src)||
0==q.els.src.length)throw Error("CL87");d=p.Client.ElementType;n=p.Client.FunctionType;H=p.Client.CollectionType;N=p.Client.SelectionType;m=p.Models.OperatorType;v=p.Client.InputType;u=p.Client.CalculationType;Q=p.Common.ValueInputType;gb=$rule.getBounds;uc=p.Client.browser==p.Client.type.IE;bc=p.Client.browser==p.Client.type.Opera;tc=0;C.container=document.getElementById(C.id);C.fieldId?C.field=document.getElementById(C.fieldId):C.clientOnly=!0;aa(null);h(q.els.str)&&q.els.str.length||(q.els.str=
[]);q.els.ens&&0<q.els.ens.length?dd(q.els.ens,!0):q.els.ens=[];q.els.mds&&0<q.els.mds.length?dd(q.els.mds,!1):q.els.mds=[];if(C.clientOnly){if(h(q.tId)&&h(q.tUrl)){var a=Yc(document,q.tId);0<a.length&&(a[0].href=q.tUrl)}h(q.tCoId)&&h(q.tCoUrl)&&(a=Yc(document,q.tCoId),0<a.length&&(a[0].href=q.tCoUrl))}q.els.ms=q.help&&h(p.Help)?p.Help:{};q.els.er=p.Errors;C.asp||C.clientOnly||(C.form=p.getParentByTagName(C.container,"FORM"),h(C.form)&&p.addHandlers(C.form,{submit:Dc},this));a="_"+C.id;var b=document.getElementById(a);
h(b)&&(b.innerHTML="");q.tools?(ad(),Jd()):(J=document.getElementById("ceT"+C.container.id),h(J)&&J.parentNode.removeChild(J),J=null);if(q.help)if(h(q.els.ms.i101)){var e="ceH"+C.container.id;M=document.getElementById(e);h(M)&&M.parentNode.removeChild(M);M=document.createElement("DIV");M.id=e;M.className="ceHelp";C.container.appendChild(M);M.innerHTML=q.els.ms.i101}else ed();else ed();h(b)||(b=document.createElement("DIV"),b.id=a);b.className="ceRule";C.container.appendChild(b);C.container=b;fd();
w=2;y="";Za=!1;ec("ceMenu");ec("ceTime");Eb||(ka=new p.Menu.Control("ceMenu",C.useZindex),Ca=new p.Calendar.Control(C.useZindex),ja=new p.Time.Picker("ceTime",C.useZindex),p.addHandlers(document,{click:Kd},this),p.addHandlers(C.container,{touchstart:Ld},this),p.addHandlers(C.container,{touchend:Md},this),p.addHandlers(C.container,{touchmove:Nd},this),p.addHandlers(C.container,{contextmenu:Od},this),p.addHandlers(document,{keydown:Pd,keypress:Qd,keyup:Rd},this),ka.init(this,q.help?Ra:null),p.addHandlers(window,
{resize:cd},this),Eb=!0);wb=!1;wc&&Ac();vc&&Bc();vc=wc=!1},Ac=function(){wb=!1;if(h(q)){var a=Gb.deserialize(Yb);if(0!=a.length){Fa=a[0].g;q.isEval=a[0].v;if(q.tools){h(Fa)&&$c();var b=a[0].n,e=a[0].d;h(b)&&0<b.length?(T.setValue(Zb(b)),T.setClass("ceNameBox")):(T.setValue(""),T.setClass("ceNameBoxDefault"));h(e)&&0<e.length?(X.setValue(Zb(e)),X.setClass("ceDescriptionBox")):(X.setValue(""),X.setClass("ceDescriptionBoxDefault"))}Xa=a.length+1;gd();for(var g,l,t=null,x=null,r=0,B=0,E,O=null,Sa=1;Sa<
a.length;Sa++){b=a[Sa];if(!h(b))break;E=!1;if(b.t==d.NewLine)xb(!1,!0);else if(b.t==d.Tab)ca({t:b.t,id:null,v:"",n:"&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:!0});else{e=h(b.n)?b.n:null;switch(b.t){case d.Flow:l=G(q.els.fls,b.v);if(!h(l)){alert("This rule cannot be properly loaded using the current Mode");return}switch(b.v){case "if":g=q.isEval?q.evalIf:q.execIf;break;case "elseIf":g=4==q.mode?q.isEval?q.evalIf:q.execIf:l.n;break;default:g=l.n}break;case d.LeftSource:g=q.els.lbl.ub;break;case d.RightSource:g=
q.els.lbl.ue;break;case d.LeftParenthesis:g=q.els.lbl.pb;break;case d.RightParenthesis:g=q.els.lbl.pe;break;case d.LeftBracket:g=q.els.lbl.cb;break;case d.RightBracket:g=q.els.lbl.ce;break;case d.Action:case d.Function:switch(b.f){case n.Name:B=0;F=null;if(b.d)r=0,g=b.v,E=!0;else{l=G(b.t==d.Action?z.acs:z.fds,b.v);if(!h(l))throw Error("CL11");g=0<l.ps.length?l.n+"&nbsp;(":l.n;r=l.ps.length;b.t==d.Function&&(l.rt.o==m.Enum?F=Ib(l.rt.e):l.rt.o==m.Numeric&&h(l.rt.mds)?F=yb(l.rt.mds,l.ftr):l.rt.o==m.Date?
t=l.rt.f:l.rt.o==m.Time&&(x=l.rt.f))}break;case n.Param:if(b.i==v.Field)l=G(z.fds,b.v),h(l)?g=l.n:(g=b.v,E=!0);else if(b.o==m.String)g=p.encode(p.decode(b.v));else if(b.o==m.Numeric)l=Aa(c),l.ps.length>=B&&h(l.ps[B].mds)?(g=yb(l.ps[B].mds,l.ps[B].ftr),h(g)&&0<g.length?(b.i=v.Field,g=G(g,b.v),h(g)?g=g.Name:(g=b.v,E=!0)):(E=!0,g=b.v)):g=b.v;else if(b.o==m.Date)g=p.formatDate(new Date(b.v),h(b.r)?b.r:Ca.defaultFormat());else if(b.o==m.Time)g=p.formatDate(new Date("1/1/2010 "+b.v),h(b.r)?b.r:ja.defaultFormat());
else if(b.o==m.Enum)g=G(Ib(b.e),b.v),h(g)?g=g.Name:(g=b.v,E=!0);else if(b.o==m.Bool)g=$b(b.v);else throw Error("CL22");B++;break;case n.Comma:g=",";break;case n.End:g=0<r?")":"&nbsp;";r=B=0;break;default:throw Error("CL36");}break;case d.Calculation:switch(b.c){case u.Function:switch(b.f){case n.Name:B=0;F=null;if(b.d)r=0,g=b.v,E=!0;else{l=G(z.fds,b.v);if(!h(l))throw Error("CL11");g=0<l.ps.length?l.n+"&nbsp;(":l.n;r=l.ps.length;if(l.rt.o!=m.Numeric)throw Error("CL13");h(l.rt.mds)&&(F=yb(l.rt.mds,
l.ftr))}break;case n.Param:if(b.i==v.Field)l=G(z.fds,b.v),h(l)?g=l.n:(g=b.v,E=!0);else if(b.o==m.String)g=p.encode(p.decode(b.v));else if(b.o==m.Numeric)l=Aa(c),l.ps.length>=B&&h(l.ps[B].mds)?(g=yb(l.ps[B].mds,l.ps[B].ftr),h(g)&&0<g.length?(b.i=v.Field,g=G(g,b.v),h(g)?g=g.Name:(g=b.v,E=!0)):(E=!0,g=b.v)):g=b.v;else if(b.o==m.Date)g=p.formatDate(new Date(b.v),h(b.r)?b.r:Ca.defaultFormat());else if(b.o==m.Time)g=p.formatDate(new Date("1/1/2010 "+b.v),h(b.r)?b.r:ja.defaultFormat());else if(b.o==m.Enum)g=
G(Ib(b.e),b.v),h(g)?g=g.Name:(g=b.v,E=!0);else if(b.o==m.Bool)g=$b(b.v);else throw Error("CL22");B++;break;case n.Comma:g=",";break;case n.End:g=0<r?")":"&nbsp;";r=B=0;break;default:throw Error("CL36");}break;case u.Field:l=G(z.fds,b.v);h(l)?g=l.n:(g=b.v,E=!0);break;case u.Number:g=b.v;break;case u.LeftParenthesis:g=q.els.lbl.pb;break;case u.RightParenthesis:g=q.els.lbl.pe;break;case u.Multiplication:g="&#215;";break;case u.Division:g="&#247;";break;case u.Addition:g="&#43;";break;case u.Subtraction:g=
"&#150;";break;default:throw Error("CL90");}break;case d.Field:b.d?(g=b.v,F=t=x=null,E=!0):(l=G(z.fds,b.v),h(l)?(F=b.o==m.Enum||b.o==m.Collection&&l.co==m.Enum?h(l.e)?Ib(l.e):l.ens:(b.o==m.Numeric||b.o==m.Collection&&l.co==m.Numeric)&&h(l.mds)?yb(l.mds,l.ftr):null,t=b.o==m.Date&&h(l.f)?l.f:null,x=b.o==m.Time&&h(l.f)?l.f:null,g=l.n):(g=b.v,F=t=x=null));break;case d.Exists:h(b.v)||(b.v=b.y==N.DoesNotExist?"ce803":"ce802");g=Ec(b.v);break;case d.Where:g=Jb(q.els.dsc,"where");break;case d.Clause:g=G(q.els.cls,
b.v);if(h(g))g=G(q.els.cls,b.v).n;else{alert("This rule cannot be properly loaded using the current Mode");return}break;case d.Setter:g=Jb(q.els.str,b.v);break;case d.Operator:g=hd(b.v,b.o);h(g)?g=g.n:(g="is",E=!0);break;case d.Value:b.o==m.Enum?h(F)&&0!=F.length?(l=G(F,b.v),h(l)?g=l.Name:(l=G(z.fds,b.v),h(l)?g=l.n:(g=b.v,E=!0))):(g="[Unknown]",E=!0):b.i==v.Field?(l=G(z.fds,b.v),h(l)?g=l.n:(g=b.v,E=!0)):b.o==m.String?g=0==b.v.length?q.els.lbl.em:p.encode(p.decode(b.v)):b.o==m.Numeric?h(F)&&0<F.length?
(b.i=v.Field,g=G(F,b.v),h(g)?g=g.Name:(g=b.v,E=!0)):g=b.v:g=b.o==m.Date?p.formatDate(new Date(b.v),h(t)?t:Ca.defaultFormat()):b.o==m.Time?p.formatDate(new Date("1/1/2010 "+b.v),h(x)?x:ja.defaultFormat()):$b(b.v)}ca({t:b.t,id:e,v:b.v,n:g,st:b.o,ct:b.c,co:b.co,cn:b.cn,ft:b.f,it:b.i,h:!0,fv:b.q},!1);b.t!=d.LeftSource&&b.t!=d.RightSource||aa(c);zb(b.t,b.o,b.c,b.i)&&Oa();E&&(c.className+=" ceWarn",O=q.els.er.e107)}}F=Yb=null;w=0;Rb();h(O)&&alert(O)}}else wc=!0},Bc=function(){if(h(q)){var a=Gb.deserialize(Xb);
if(0!=a.length){a[0].e&&h(T)&&(T.setValue(q.els.er.e104),T.setClass("ceNameBox ceError"));for(var b=1;b<a.length;b++){var e=a[b],g=document.getElementById(e.c||e.ClientID);h(g)&&(g.className+=" ceHighlight",g.title=e.h||e.Hint,W.push(g.id))}q.help&&(1<a.length?(Kb(q.els.er.e102),M.className+=" ceError"):a[0].e&&(Kb(q.els.er.e103),M.className+=" ceError"));Xb=null}}else vc=!0},Dc=function(){C.clientOnly||(vb=!1,C.field.value=Gb.serialize(dc()))},dc=function(){if(0<p.getChildrenByTagName(C.container,
"INPUT",!1).length)Sb(q.els.er.e114);else{aa(null);var a=$a(),b=!1,e=new p.Models.RuleModel;e.Elements=[];h(Fa)&&(e.Id=Fa);e.IsLoadedRuleOfEvalType=q.isEval;e.Command=Hb;e.Mode=q.mode;if(!vb){if(q.tools){var g=T.getValue();e.Name=0==p.trim(g).length||p.trim(g).toLowerCase()==q.els.er.e104.toLowerCase()?null:Qb(g);g=X.getValue();e.Desc=0==p.trim(g).length||p.trim(g).toLowerCase()==q.els.er.e104.toLowerCase()?null:Qb(g);e.SkipNameValidation=!1}else e.SkipNameValidation=!0;for(var l=0;l<a.length;l++){var t=
a[l];var x=D(t);if(h(x)&&x!=d.HtmlTag){g=new p.Client.Element;g.Type=x;g.Name=t.id;g.Oper=Ba(t,!0);g.FuncType=U(t);g.InpType=Ua(t);g.CalType=qa(t);switch(x){case d.Field:g.Value=t.getAttribute("ce208");g.IsRule="true"==t.getAttribute("ce213");var r=G(z.fds,g.Value);b=h(r)&&h(r.mds);switch(g.Oper){case m.String:h(r)&&(g.Max=r.max);break;case m.Numeric:h(r)&&(g.Dec=r.dec,g.Cal=r.cal,g.Min=r.min,g.Max=r.max,h(r.mds)&&(g.InpType=v.Input,b=!0));break;case m.Date:case m.Time:h(r)&&(g.Format=r.f);break;
case m.Enum:h(r)&&(g.En=r.e);break;case m.Collection:if(h(r)&&(g.CollType=r.ct,r.ct==H.Value))switch(r.co){case m.String:g.Max=r.max;break;case m.Numeric:g.Dec=r.dec;g.Cal=r.cal;g.Min=r.min;g.Max=r.max;r.co==m.Numeric&&h(r.mds)&&(g.InpType=v.Input,b=!0);break;case m.Date:case m.Time:g.Format=r.f;break;case m.Enum:g.En=r.e}}break;case d.RightSource:case d.LeftSource:aa(t);g.Value=t.getAttribute("ce208");break;case d.Value:g.Value=g.Oper==m.String?$rule.decode(t.getAttribute("ce206"),!0):t.getAttribute("ce206");
g.Oper==m.Numeric&&b&&(r=G(z.fds,g.Value),h(r)||(g.InpType=v.Input));b=!1;break;case d.Calculation:h(t.getAttribute("ce206"))&&(g.Value=t.getAttribute("ce206"));break;case d.Action:case d.Function:if(x==d.Function&&g.FuncType==n.Name)g.Value=t.getAttribute("ce208"),g.IsFuncValue="true"==t.getAttribute("ce216"),r=G(z.fds,g.Value),b=h(r)&&h(r.rt.mds);else if(g.FuncType==n.Param){var B=t;x=g.Oper;r=Aa(B);var E=null;h(r)&&(B=lb(B),E=0<=B&&r.ps.length>=B&&r.ps[B].o==x?r.ps[B]:id(r,x,0>B?0:B));x=E;if(g.InpType==
v.Input){r=!1;if(h(x))switch(g.Oper){case m.String:g.Max=x.max;h(t.getAttribute("ce206"))&&(g.Value=$rule.decode(t.getAttribute("ce206"),!0));r=!0;break;case m.Numeric:g.Dec=x.dec;g.Min=x.min;g.Max=x.max;break;case m.Date:case m.Time:g.Format=x.f;break;case m.Enum:g.En=x.e}!r&&h(t.getAttribute("ce206"))&&(g.Value=t.getAttribute("ce206"))}else g.Value=t.getAttribute("ce208"),r=G(z.fds,g.Value),h(x)&&x.o==m.Numeric&&h(x.mds)&&!h(r)&&(g.InpType=v.Input)}else g.Value=t.getAttribute("ce208"),x==d.Function&&
(g.IsFuncValue="true"==t.getAttribute("ce216"),G(z.fds,g.Value));break;case d.Exists:case d.Where:switch(t.getAttribute("ce208")){case "ce803":g.SelType=N.DoesNotExist;break;default:g.SelType=N.Exists}x=mb(t,d.Field);h(x)?(r=G(z.fds,x.getAttribute("ce208")),h(r)?g.CollType=r.ct:g.CollType=H.Generic):g.CollType=H.Generic;g.Value=t.getAttribute("ce208");break;default:g.Value=t.getAttribute("ce208")}e.Elements.push(g)}}}return e}},Nd=function(a){a.preventDefault();a.stopPropagation();return!1},Od=function(a){a.preventDefault();
a.stopPropagation();return!1},Ld=function(a){if(9==w)return!1;ua=a.target;pa=R=kb=0;Ma=(new Date).getTime();a.changedTouches&&(a=a.changedTouches[0],Db=a.pageX,ea=a.pageY);K=setTimeout(function(){0===kb&&(h(ua)&&h(ua.getAttribute("ce202"))?jd({keyCode:13}):Fc({keyCode:32}));K=null},600)},Md=function(a){h(K)&&clearTimeout(K);K=null;a.changedTouches&&(a=a.changedTouches[0],R=a.pageX-Db,pa=a.pageY-ea,250>=(new Date).getTime()-Ma&&(60<=Math.abs(R)&&30>=Math.abs(pa)?kb=0>R?4:2:60<=Math.abs(pa)&&30>=Math.abs(R)&&
(kb=0>pa?1:3)));switch(kb){case 2:Gc({keyCode:127});break;case 3:Fc({keyCode:32});break;case 4:Gc({keyCode:8})}},Xd=function(a){function b(L){Pa(L)?hb(L):c=I(L)}function e(L){L=Hc(c,n.End);h(L)&&(c=I(L),pb())}function g(L,Ha){var ha=ab(c),wa=null;if(ha&&(wa=xa(L.previousSibling),D(wa)==d.Function)){var na=Tb(wa,n.Name);if(!h(na))return;wa=xa(na.previousSibling)}na=[];if(qa(c)==u.Function)for(ha=fc(Ha),V("ce801",m.Numeric,qb(m.Numeric),na),wa=0;wa<ha.length;wa++)na.push(ha[wa]);else{na=Ba(L,!0);wa=
!ha||D(wa)==d.Setter&&"to"==wa.getAttribute("ce208");var da=G(z.fds,Ha);if(h(da)){var Lb=h(da.ftr)?da.ftr:null;da=da.t==d.Function?da.rt:da;var Ic=da.o;var kd=da.co;var Jc=da.e;var Kc=da.mds;h(da.mds)&&(Lb=null);var Sd=da.cc;var Td=da.cl;var Ud=da.cv;var Mb=[];if(h(da)&&"true"==c.getAttribute("ce216")){var la=da.t==d.Function?da.rt.ai:da.ai,rb=da.t==d.Function?da.rt.o:da.o;(rb==m.Numeric&&da.t==d.Function?da.rt.cal:da.cal)&&V("C",rb,q.els.lbl.c,Mb);la==Q.All&&V("ce801",rb,qb(rb),Mb)}for(da=0;da<z.fds.length;da++)la=
z.fds[da],la.ir&&ha||ha&&h(la.st)&&!la.st||la.ir&&(h(Fa)&&la.v==Fa||na!=m.Bool)||la.v==Ha||(rb=h(la.ftr)?la.ftr:null,la.t==d.Function?wa&&(la.rt.o!=na||Ic==m.Enum&&Jc!=la.rt.e||la.mds!=Kc||null!=Lb&&"any"!=Lb&&Lb!=rb&&"any"!=rb||Mb.push(la)):Ic==m.Collection&&la.o==m.Collection?la.ct==H.Reference&&la.cc==Sd&&la.cl==Td&&la.cv==Ud?Mb.push(la):la.ct!=H.Value||la.co!=kd||kd==m.Enum&&Jc!=la.e||la.mds!=Kc||Mb.push(la):la.o!=na||Ic==m.Enum&&Jc!=la.e||la.mds!=Kc||null!=Lb&&"any"!=Lb&&Lb!=rb&&"any"!=rb||Mb.push(la));
na=Mb}else na=[]}0<na.length?(fa=!0,A(na,L,t,null)):ab(c)||(Da=!1,ha=G(z.fds,Ha),h(ha)&&(ha.t==d.Function?0<ha.ps.length?(c=I(L),ib(ha)):Ub(ha):ha.o==m.Collection&&ha.ct!=H.Value||A(sb(ha),L,nb,null)))}function l(L,Ha){for(var ha=[],wa,na=0;na<z.acs.length;na++)wa=z.acs[na],wa.v!=Ha&&ha.push(wa);1<ha.length||1==ha.length&&ha[0].v!=Ha?(fa=!0,A(ha,L,x,null)):(Da=!1,ha=gc(),0<ha.length&&A(ha,c,hc,null))}function t(L,Ha){var ha="true"==c.getAttribute("ce216"),wa=qa(c)==u.Function;D(c)==d.Function||D(c)==
d.Calculation&&U(c)==n.Name?e(L):Y=!0;if("ce801"==L)switch(parseInt(Ha,10)){case m.Numeric:cb({t:wa?d.Calculation:d.Value,v:"",st:m.Numeric,ct:wa?u.Number:u.None,ft:n.None,span:c});break;default:ac(xa(c))}else if("C"==L)Lc(L);else{var na=G(z.fds,L);na.t==d.Function?Vb({t:wa?d.Calculation:na.t,m:L,v:ha}):wa?Ia(u.Field,L):ha?ld(na,L,wa):(tb(na,null),!ra()||ab(c)||na.o==m.Collection&&na.ct!=H.Value||A(sb(na),c,nb,null))}}function x(L){e(L);Vb({t:G(z.acs,L).t,m:L,v:!1})}if(9==w)return!1;Y=fa=Da=Za=!1;
var r=a.target;if(h(p.getParentById(r,C.container.id))){aa(c);(h(c)&&r.id!=c.id&&"INPUT"==c.tagName||"INPUT"!=r.tagName)&&Oa();Na=0;if(6==w||8==w){ka.close();w=md()?0:2;return}if(4==w)Ab(),w=0;else if(3==w)Bb(),w=0;else if(2==w||1==w&&!h(c))gd(),ca({t:d.Flow,id:null,v:"if",n:q.isEval?q.evalIf:q.execIf,st:null,ct:null,ft:null,it:null,h:!1,fv:!1}),c=I(c),A(Ja(),c,Ka,d.LeftParenthesis);else{if(a.ctrlKey||a.metaKey)return"true"==r.getAttribute("ce218")?(r.className=p.trim(r.className.replace("ceSelected",
"")),r.setAttribute("ce218","false")):(r.className=p.trim(r.className)+" ceSelected",r.setAttribute("ce218","true")),r=p.getChildrenByAttribute(C.container,"ce218","true"),0<r.length?Ra("i137"):Ra(),!1;ic();var B=!0;if(h(r.getAttribute("ce202"))){if(0==w&&"INPUT"==r.tagName)return!0;a=qa(r);var E=Ua(r),O=Ba(r,!0);zb(D(r),O,a,E)&&E!=v.Field?cb({t:D(r),v:r.getAttribute("ce206"),st:O,ct:a,ft:U(r),span:r,pi:lb(c)}):b(r)}else{Oa();B=!1;r=$a();O=!1;for(var Sa=p.Client.browser==p.Client.type.IE&&9>p.Client.version?
p.getScrollHeight():0,jb=0;jb<r.length;jb++){if(!h(r[jb].nextSibling)){b(r[jb]);O=!0;break}E=gb(D(r[jb].nextSibling)==d.HtmlTag?r[jb].nextSibling.nextSibling:r[jb].nextSibling);if(E.y>a.offsetY+Sa){b(r[jb]);O=!0;break}}!O&&0<r.length&&b(r[r.length-1])}Da=q.clicks&&h(c)&&B&&!h(c.getAttribute("ce207"));aa(c);va();w=0;if(Da)switch(B=c.getAttribute("ce208"),D(c)){case d.Flow:"else"==B?A(db(),c,eb,null):A(Ja(),c,Ka,d.LeftParenthesis);break;case d.Function:switch(U(c)){case n.Param:B=Aa(c);Y=fa=!0;ib(B);
break;case n.Name:g(c,B);break;case n.End:Pa(c)&&g(c.previousSibling,B)}break;case d.Field:g(c,B);break;case d.LeftParenthesis:case d.LeftSource:A(Ja(),c,Ka,d.LeftParenthesis);break;case d.RightParenthesis:case d.RightBracket:case d.RightSource:A(sa(),c,oa,d.RightParenthesis);break;case d.Action:switch(U(c)){case n.Param:B=Aa(c);Y=fa=!0;ib(B);break;case n.Name:l(c,B);break;case n.End:Pa(c)&&l(c.previousSibling,B)}break;case d.Setter:"set"==B?A(Nb(),c,Ob,null):fb(xa(c));break;case d.LeftBracket:A(Va(),
c,Ia,null);break;case d.Calculation:a=[];switch(qa(c)){case u.LeftParenthesis:Y=fa=!1;A(Va(),c,Ia,null);break;case u.RightParenthesis:Y=fa=!1;A(Va(),c,Ia,null);break;case u.Function:switch(U(c)){case n.Name:g(c,B);break;case n.End:Pa(c)&&g(c.previousSibling,B)}break;case u.Field:nd(B);break;case u.Addition:V(u.Subtraction,null,"&#150;",a);V(u.Multiplication,null,"&#215;",a);V(u.Division,null,"&#247;",a);Y=fa=!0;A(a,c,Ia,null);break;case u.Subtraction:V(u.Addition,null,"&#43;",a);V(u.Multiplication,
null,"&#215;",a);V(u.Division,null,"&#247;",a);Y=fa=!0;A(a,c,Ia,null);break;case u.Multiplication:V(u.Addition,null,"&#43;",a);V(u.Subtraction,null,"&#150;",a);V(u.Division,null,"&#247;",a);Y=fa=!0;A(a,c,Ia,null);break;case u.Division:V(u.Addition,null,"&#43;",a),V(u.Subtraction,null,"&#150;",a),V(u.Multiplication,null,"&#215;",a),Y=fa=!0,A(a,c,Ia,null)}break;case d.Operator:a=Ya(c);h(a)&&(a=G(z.fds,a.getAttribute("ce208")),h(a)&&(a=sb(a,B),h(a)&&0<a.length?(Y=fa=!0,A(a,c,nb,null)):(Da=!1,"isNull"==
B||"isNotNull"==B?A(sa(),c,oa,d.RightParenthesis):fb(xa(c)))));break;case d.Clause:"then"==B?A(db(),c,eb,null):ab(c)?A(db(),c,eb,null):(B=Vd(B),h(B)&&0<B.length?(Y=fa=!0,A(B,c,oa,null)):A(Ja(),c,Ka,d.LeftParenthesis));break;case d.Exists:a=[];switch(B){case "ce803":V("ce802",d.Field,q.els.lbl.h,a);break;default:V("ce803",d.Field,q.els.lbl.l,a)}Y=fa=!0;A(a,c,Wd,null);break;case d.Value:qa(c)==u.Function?nd(B):(B=Ba(c,!0),Y=B!=m.Date&&B!=m.Time,fa=!0,fb(xa(c)))}}Ra()}else 8==w?(ic(),Oa(),aa(c),r.id!=
Qa.id&&(ka.close(),w=1),Ra()):(ic(),Oa(),B=Ca.getId(),3==w&&null!=B&&h(p.getParentById(r,B))||Rb(),h(C.container)&&h(C.container.childNodes)&&1<C.container.childNodes.length&&Ra("i102"));return!0},jd=function(a){if(9==w)return!1;ma=!0;Y=fa=Da=!1;if(1==w||2==w)return aa(),!0;var b=a.keyCode;if(16==b||17==b||18==b)return 6==w?ka.close():3==w?Bb():4==w&&Ab(),w=0,!0;a.ctrlKey||a.metaKey?y="":(ic(),aa(c));if(27==b||0!=w&&(8==b||127==b))ma=!1;32==b&&0<y.length&&(y+=" ");6!=w&&8!=w||40!=b||sc++;if((6==w||
8==w)&&37!=b&&39!=b&&(38!=b||0<sc))return!0;if(4==w||3==w){if(13==b)return!0;4==w?Ab():Bb();w=0}var e=D(c),g=Ba(c,!0);switch(b){case 9:y="";e!=d.NewLine&&e!=d.Tab||ca({t:d.Tab,id:null,v:"",n:"&nbsp;",st:null,ct:u.None,ft:null,it:null,h:!1,fv:!1});ma=!1;break;case 13:y="";e==d.Calculation&&qa(c)==u.Number?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ra()&&A(Va(),c,Ia,null)):(a.ctrlKey||a.metaKey)&&Ua(c)!=v.Field?cb({t:e,v:c.getAttribute("ce206"),st:g,ct:u.Number,ft:U(c),span:c}):xb(!1):e==d.Value?
g==m.String||g==m.Numeric?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ra()&&A(sa(),c,oa,d.RightParenthesis)):(a.ctrlKey||a.metaKey)&&Ua(c)!=v.Field?cb({t:e,v:c.getAttribute("ce206"),st:g,ct:qa(c),ft:U(c),span:c}):xb(!1):xb(!1):e==d.Function||e==d.Action?g==m.String||g==m.Numeric?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ib(Aa(c))):(a.ctrlKey||a.metaKey)&&Ua(c)!=v.Field&&cb({t:D(c),v:c.getAttribute("ce206"),st:Ba(c,!0),ct:qa(c),ft:U(c),span:c,pi:lb(c)}):Pa(c)?(hb(c),xb(!1)):U(c)==n.End&&xb(!1):
Wb(c)&&(h(c.nextSibling)&&U(c.nextSibling)==n.End&&0==Aa(c).ps.length&&(e=jc(c),h(e)&&(c=e)),xb(!1));ma=!1;break;case 88:if(a.ctrlKey||a.metaKey)return od(!0,"i139"),ma=!1;break;case 67:if(a.ctrlKey||a.metaKey)return od(!1,"i138"),ma=!1;break;case 86:if((a.ctrlKey||a.metaKey)&&0<S.length){6==w?ka.close():3==w?Bb():4==w&&Ab();a=h(c)&&h(c.nextSibling);b=[];e=0;for(var l;e<S.length;e++)l=S[e],l.id=C.container.id+Xa,Xa++,a?C.container.insertBefore(l,c.nextSibling):C.container.appendChild(l),c=I(l),b.push(c.cloneNode(!0));
S=b;return ma=!1}break;case 34:Na=0;Oa();e=$a();c=I(e[e.length-1]);e=gb(c);Mc(e.y,e.height);Pa(c)&&hb(c);aa(c);va();ma=!1;break;case 35:Na=0;Oa();e=mb(c,d.HtmlTag);h(e)?c=I(e.previousSibling):(e=$a(),c=I(e[e.length-1]));Pa(c)&&hb(c);aa(c);va();ma=!1;break;case 33:Na=0;Oa();c=I($a()[0]);aa(c);kc(gb(c).y);va();ma=!1;break;case 36:Na=0;Oa();e=Nc(c,d.NewLine);if(!h(e)&&(e=$a()[0],"if"!=e.getAttribute("ce208")))throw Error("CL02");c=I(e);aa(c);va();ma=!1;break;case 38:6!=w&&8!=w||Ta();zb(e,g,qa(c),Ua(c))&&
h(c.getAttribute("ce207"))&&(Oa(),c=I(c));if(a.ctrlKey||a.metaKey)ia=c.id;g=$a();var t=gb(c),x=null;0==Na&&(Na=t.x+t.width);var r=!1;for(e=g.length-1;-1<e;e--)if(r){var B=g[e];var E=D(B);if(h(x)&&(E==d.NewLine||bb(B))){c=I(B);kc(l.y);break}l=gb(B);if(!(l.y>t.y-parseInt(l.height/2,10)))if(h(x)||(x=B),Na>l.x+l.width||!h(B.previousSibling)||gb(B.previousSibling).y<l.y){c=I(B);kc(l.y);break}else if(E=l.x+parseInt(l.width/2,10),Na>E){kc(l.y);c=I(B);break}}else r=g[e].id==c.id;Pa(c)&&hb(c);aa(c);va();if(a.ctrlKey||
a.metaKey)l=D(c),l==d.Flow&&bb(c)&&(c=I(Wa(c.nextSibling)),aa(c)),lc(!1),Ra("i137");ma=!1;break;case 40:zb(e,g,qa(c),Ua(c))&&h(c.getAttribute("ce207"))&&(Oa(),c=I(c));e=!1;if(a.ctrlKey||a.metaKey)l=D(c),l==d.Flow&&bb(c)&&(c=I(Wa(c.nextSibling)),aa(c),e=!0),l=xa(c),!Wb(c)&&D(l)==d.Flow&&bb(l)&&(c=I(Wa(c.nextSibling)),aa(c),e=!0),ia=c.id;if(!e){e=$a();l=gb(c);0==Na&&(Na=l.x+l.width);x=!1;for(B=e.length-1;-1<B;B--){t=e[B];if(t.id==c.id)break;g=gb(t);x||(x=g.y-l.height-parseInt(l.height/2,10)<l.y);if(x)if(r=
gb(t.previousSibling),Na>g.x+g.width||!h(r)||r.y<g.y){c=I(t);Mc(g.y,g.height);break}else if(r=g.x+parseInt(g.width/2,10),Na>=r){c=I(t);Mc(g.y,g.height);break}}Pa(c)&&hb(c);aa(c);va()}if(a.ctrlKey||a.metaKey)lc(!0),Ra("i137");ma=!1;break;case 37:Na=0;ma=!1;6!=w&&8!=w||Ta();if("INPUT"==c.tagName)return!1;if(h(c.previousSibling)){g=!1;e=null;if(a.ctrlKey||a.metaKey)if(t=xa(c.previousSibling),l=D(t),l==d.Flow&&bb(t)){if(g=!0,h(c.nextSibling)&&(l=D(c),l==d.Tab||l==d.NewLine||l==d.HtmlTag))c=I(Wa(c.nextSibling)),
aa(c)}else ia=c.id;!g&&(h(c.previousSibling)&&(l=D(c.previousSibling),c=I(l==d.HtmlTag?c.previousSibling.previousSibling:c.previousSibling),aa(c)),Pa(c)&&(U(c)==n.End?hb(c):c=I(c.previousSibling)),g=xa(c),l=D(g),(a.ctrlKey||a.metaKey)&&l==d.Flow&&bb(g)?h(c.nextSibling)&&(l=Wa(c.nextSibling),c=I(l),aa(c)):aa(c),va(),a.ctrlKey||a.metaKey)&&(lc(!1),e="i137");Ra(e)}break;case 39:Na=0;ma=!1;6!=w&&8!=w||Ta();if(!a.ctrlKey&&!a.metaKey)if(e==d.Value&&(g==m.String||g==m.Numeric)){if(h(c.getAttribute("ce207")))return!1;
c=I(c);va()}else if(e==d.Calculation&&Ua(c)==v.Input&&qa(c)==u.Number){if(h(c.getAttribute("ce207")))return!1;c=I(c);va()}else{if(!(e!=d.Function&&e!=d.Action||Ua(c)!=v.Input||g!=m.String&&g!=m.Numeric)){if(h(c.getAttribute("ce207")))return!1;c=I(c);va()}}else if("INPUT"==c.tagName)return!1;if(h(c.nextSibling))if(a.ctrlKey||a.metaKey||!Pa(c.nextSibling)){e=!1;if(a.ctrlKey||a.metaKey)l=D(c),l==d.Flow&&bb(c)&&(c=I(Wa(c.nextSibling)),aa(c),e=!0),l=xa(c),!Wb(c)&&D(l)==d.Flow&&bb(l)&&(c=I(Wa(c.nextSibling)),
aa(c),e=!0),ia=c.id;e||(c=D(c.nextSibling)==d.HtmlTag?I(c.nextSibling.nextSibling):I(c.nextSibling),aa(c));if(a.ctrlKey||a.metaKey)lc(!0),Ra("i137");else{e=D(c);l=ra();if(h(c.nextSibling)||e!=d.RightBracket)if(e!=d.Function&&e!=d.Action||!l)e==d.Flow&&l?"else"==c.getAttribute("ce208")?A(db(),c,eb,null):A(Ja(),c,Ka,d.LeftParenthesis):e!=d.LeftParenthesis&&e!=d.LeftSource||!l?e!=d.RightParenthesis&&e!=d.RightSource&&e!=d.RightBracket&&e!=d.Value||!l?e==d.Field&&l?ab(c)||(e=c.getAttribute("ce208"),G(z.fds,
e).ct!=H.Reference&&A(sb(G(z.fds,e)),c,nb,null)):e==d.Exists&&l?A(Oc(mb(c,d.Field).getAttribute("ce208")),c,Pc,null):e==d.Setter&&l?"set"==c.getAttribute("ce208")?A(Nb(),c,Ob,null):(fb(xa(c)),pd()&&A(sa(),c,oa,null)):e==d.Operator&&l?"isNull"==c.getAttribute("ce208")||"isNotNull"==c.getAttribute("ce208")?A(sa(),c,oa,d.RightParenthesis):(fb(c,!0),pd()&&A(sa(),c,oa,d.RightParenthesis)):e==d.Clause&&l?"then"==c.getAttribute("ce208")||ab(c)?A(db(),c,eb,null):A(Ja(),c,Ka,d.LeftParenthesis):e!=d.LeftBracket&&
e!=d.Calculation||!l||A(Va(),c,Ia,null):A(sa(),c,oa,d.RightParenthesis):(e==d.LeftSource&&aa(c),A(Ja(),c,Ka,d.LeftParenthesis));else switch(U(c)){case n.End:Ub(Aa(c));break;case n.Name:e=Aa(c),0<e.ps.length&&U(c.nextSibling)==n.End&&ib(e)}else A(sa(),c,oa,d.RightParenthesis);Ra()}}else hb(c.nextSibling),aa(c),va(),Ub(Aa(c))}if(bc)return 8==b&&a.preventDefault(),!1;if(uc&&13==b||8==b&&!h(c.getAttribute("ce207"))||9==b||33==b||34==b||35==b||36==b||38==b||39==b||40==b)a.preventDefault&&a.preventDefault(),
a.stopPropagation&&a.stopPropagation();return ma},Fc=function(a){if(9==w)return!1;var b=a.keyCode;Za=!1;if(!ma)return ma=!0,bc?(9!=b&&13!=b&&33!=b&&34!=b&&35!=b&&36!=b&&38!=b&&40!=b||a.preventDefault(),!1):!0;if(1==w||2==w)return!0;if((6==w||8==w)&&!La(b)||(6==w||8==w)&&38==b)return!1;if(3!=w&&4!=w){var e=y;y="";if(8==w)32==b?(fa=!0,A(Z,Qa,mc,null),w=8):La(b)&&(y=e+=String.fromCharCode(b),fa=!0,ya(Z,Qa,mc,null),w=8);else{var g=xa(c);switch(D(g)){case d.Flow:"else"==g.getAttribute("ce208")?32==b?A(db(),
c,eb,null):La(b)&&(y=e+=String.fromCharCode(b),ya(db(),c,eb,null)):32==b?A(Ja(),c,Ka,d.LeftParenthesis):La(b)&&(y=e+=String.fromCharCode(b),ya(Ja(),c,Ka,d.LeftParenthesis),Za=!0);break;case d.Function:case d.Action:if(Qc(b))switch(U(g)){case n.End:if(32==b)Ub(Aa(g));else if(La(b)){var l=Aa(g);if(ra()&&(e=l.t==d.Function?sb(l):gc(),0<e.length)){l=l.t==d.Function?nb:hc;var t=qd(e,y);0<t.length?A(t,c,l,null,!0):A(e,c,l,null,!1)}}break;default:if(l=Ba(g,!0),!zb(D(g),l,qa(g),Ua(g))||l!=m.String&&l!=m.Numeric||
!h(g.getAttribute("ce207")))32==b?ib(Aa(g)):La(b)&&(y=e+=String.fromCharCode(b),ib(Aa(g)))}break;case d.LeftParenthesis:case d.LeftSource:32==b?A(Ja(),c,Ka,d.LeftParenthesis):La(b)&&(y=e+=String.fromCharCode(b),ya(Ja(),c,Ka,d.LeftParenthesis),Za=!0);break;case d.RightSource:aa(c);32==b?A(sa(),c,oa,d.RightParenthesis):La(b)&&(y=e+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis));break;case d.RightParenthesis:case d.RightBracket:32==b?A(sa(),c,oa,d.RightParenthesis):La(b)&&(y=e+=String.fromCharCode(b),
ya(sa(),c,oa,d.RightParenthesis));break;case d.Exists:32==b?A(Oc(mb(c,d.Field).getAttribute("ce208")),c,Pc,null):La(b)&&(y=e+=String.fromCharCode(b),ya(Oc(mb(c,d.Field).getAttribute("ce208")),c,Pc,null));break;case d.Field:if(32==b&&ab(g)){e=h(g.nextSibling)?jc(g.nextSibling):null;e&&D(e)==d.Setter&&"to"==e.getAttribute("ce208")||(e=G(z.fds,g.getAttribute("ce208")),h(e)&&(ca({t:d.Setter,id:null,v:"to",n:Jb(q.els.str,"to"),st:e.o,ct:u.None,ft:n.None,it:v.None,h:!1,fv:!1}),ra()&&fb(xa(g))));break}l=
G(z.fds,g.getAttribute("ce208"));l.ct!=H.Reference&&(l=sb(l),32==b?A(l,c,nb,null):La(b)&&(y=e+=String.fromCharCode(b),ya(l,c,nb,null)));break;case d.Operator:32==b?"isNull"==g.getAttribute("ce208")||"isNotNull"==g.getAttribute("ce208")?A(sa(),g,oa,d.RightParenthesis):fb(g):La(b)&&(y=e+=String.fromCharCode(b),"isNull"==g.getAttribute("ce208")||"isNotNull"==g.getAttribute("ce208")?ya(sa(),c,oa,d.RightParenthesis):h(F)&&0<F.length?ya(F,c,Rc,null):h(P.ce)&&0<P.ce.length||0<P.length?ya(P,c,Fb?rd:sd,null):
fb(g));break;case d.Clause:32==b?"then"==g.getAttribute("ce208")||ab(g)?A(db(),c,eb,null):A(Ja(),c,Ka,d.LeftParenthesis):La(b)&&(l="then"==g.getAttribute("ce208")||ab(g),y=e+=String.fromCharCode(b),ya(l?db():Ja(),c,l?eb:Ka,l?null:d.LeftParenthesis),Za=!0);break;case d.LeftBracket:32==b?A(Va(),c,Ia,null):La(b)&&(y=e+=String.fromCharCode(b),ya(Va(),c,Ia,null));break;case d.Calculation:qa(g)==u.Number?Qc(b)&&!h(g.getAttribute("ce207"))&&(32==b?A(Va(),c,Ia,null):La(b)&&(y=e+=String.fromCharCode(b),ya(Va(),
c,Ia,null))):32==b?A(Va(),c,Ia,null):La(b)&&(y=e+=String.fromCharCode(b),ya(Va(),c,Ia,null));break;case d.Setter:32==b?"set"==g.getAttribute("ce208")?A(Nb(),c,Ob,null):fb(g):La(b)&&(y=e+=String.fromCharCode(b),"set"==g.getAttribute("ce208")?(ya(Nb(),c,Ob,null),Za=!0):h(F)&&0<F.length?ya(F,c,Rc,null):fb(g));break;case d.Value:if(Qc(b))if(l=Ba(g),l==m.String||l==m.Numeric)h(g.getAttribute("ce207"))||(32==b?A(sa(),c,oa,d.RightParenthesis):La(b)&&(y=e+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis)));
else if(l==m.Numeric&&32==b)h(g.getAttribute("ce207"))||A(sa(),c,oa,d.RightParenthesis);else if(l==m.Date||l==m.Time||l==m.Bool||l==m.Enum)32==b?A(sa(),c,oa,d.RightParenthesis):La(b)&&(y=e+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis))}}}if(bc)return 8!=b&&9!=b&&32!=b&&33!=b&&34!=b&&35!=b&&36!=b&&38!=b&&40!=b||a.preventDefault(),!1;32==b?(a.preventDefault&&!h(g.getAttribute("ce207"))&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()):(8==b||9==b)&&a.stopPropagation&&a.stopPropagation()},
Gc=function(a){if(9==w)return!1;if(1==w||2==w)return!0;a=a.keyCode;if(16==a)return!1;if(8!=w){46==a&&h(c.nextSibling)&&(c=jc(c.nextSibling));var b=D(c);var e=Ba(c,!0)}switch(a){case 27:y="";if(8==w){Ta();break}6==w?Ta():3==w?(Bb(),w=0):4==w&&(Ab(),w=0);"INPUT"==c.tagName&&(Oa(),c=I(c),va());break;case 127:y="";if(8==w){Ta();break}6==w&&Ta();3==w?(Bb(),w=0):4==w?(Ab(),w=0):zb(b,e,qa(c),Ua(c))&&h(c.getAttribute("ce207"))||(h(c.nextSibling)?D(c.nextSibling)==d.HtmlTag?nc():b==d.NewLine?(Ea(c),Ea(c),
h(c.nextSibling)&&(h(c.nextSibling)&&D(c.nextSibling)==d.Tab&&nc(),c=I(h(c.nextSibling)?c.nextSibling:c),aa(c))):bb(c)?(c=c.nextSibling,pb()):(pb(),h(c.nextSibling)&&(D(c.nextSibling)==d.HtmlTag&&nc(),c=I(h(c.nextSibling)?c.nextSibling:c),aa(c))):b==d.NewLine?(Ea(c),Ea(c)):bb(c)||pb(),Pa(c)&&hb(c));break;case 8:y="",8==w?Ta():(6==w&&Ta(),3==w?(Bb(),w=0):4==w?(Ab(),w=0):(zb(b,e,qa(c),Ua(c))||(b==d.RightSource?pb():!h(c.previousSibling)||bb(c)||bb(c.previousSibling)||(D(c)==d.NewLine||D(c.previousSibling)==
d.NewLine?(c=xa(c.previousSibling),nc(),c=I(h(c.nextSibling)?c.nextSibling:c),aa(c)):bb(c.previousSibling)||(c=c.previousSibling,pb(),c=I(h(c.nextSibling)?c.nextSibling:c),aa(c)))),Pa(c)&&(hb(c),aa(c))))}return!1},Rb=function(){if(h(C)&&h(C.container)&&h(q))if(9==w)w=1;else{6==w?(ka.close(),w=1):3==w?(Bb(),w=1):4==w?(Ab(),w=1):0==w&&(w=1,h(c)&&h(c.getAttribute("ce207"))&&Oa());md()||td();2!=w&&q.help&&Kb(q.els.ms.i102);Cc();y="";Za=!1;if(h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent",
"")),Pa(c))){var a=Tb(c,n.Name);h(a)&&(a.className=$rule.trim(a.className.replace("ceCurrent","")))}aa(null)}},Vb=function(a){var b=G(a.t==d.Action?z.acs:z.fds,a.m);ca({t:a.t==d.Calculation?a.t:b.t,id:null,v:b.v,n:0<b.ps.length?b.n+"&nbsp;(":b.n,st:b.t==d.Action?null:b.rt.o,ct:a.t==d.Calculation?u.Function:u.None,ft:n.Name,it:v.None,h:!1,fv:a.v});var e=c;ca({t:a.t==d.Calculation?a.t:b.t,id:null,v:b.v,n:0<b.ps.length?")":"&nbsp;",st:b.t==d.Action?null:b.rt.o,ct:a.t==d.Calculation?u.Function:u.None,
ft:n.End,it:v.None,h:!1,fv:a.v});0<b.ps.length?(c=I(e),ra()&&ib(b)):ra()&&Ub(b)},ib=function(a){var b=lb(c);if(b>=a.ps.length-1&&!Y){var e=Hc(c,n.End);h(e)&&(c=I(e),Ub(a))}else switch(b+=1,Y&&--b,e=a.ps[b],a=[],F=null,e.ai){case Q.All:case Q.Fields:if(e.o==m.Collection){for(var g=0;g<z.fds.length;g++){var l=z.fds[g];Da&&c.getAttribute("ce208")==l.v||l.t==d.Field&&l.o==m.Collection&&(e.ct==H.Generic?l.cg&&a.push(l):l.ct==e.ct&&l.cr==e.cr&&l.cg==e.cg&&l.cv==e.cv&&l.cl==e.cl&&a.push(l))}0<y.length?ya(a,
c,ob,null):A(a,c,ob,null)}else{a:{g=e.o;var t=b;b=[];var x=Ya(c);if(h(x)){l=G(z.fds,x.getAttribute("ce208"));h(l)||(l=G(z.acs,x.getAttribute("ce208")));if(!h(l)){g=b;break a}l=l.ps[t]}if(h(l)){x=h(l.ftr)?l.ftr:null;for(var r=0,B;r<z.fds.length;r++)if(t=z.fds[r],t.t==d.Field&&!t.ir&&t.o==g){if(l.o==m.Numeric){if(l.l!=t.l||t.min<l.min||t.max>l.max||t.dec&&!l.dec||t.mds!=l.mds)continue}else if(l.o==m.Enum){if(l.e!=t.e||l.l!=t.l)continue}else if(l.l!=t.l)continue;B=h(t.ftr)?t.ftr:null;null!=x&&"any"!=
x&&x!=B&&"any"!=B||b.push(t)}}g=b}if(0<g.length){e.ai==Q.All&&V("ce801",h(e.mds)?e.mds:e.o,qb(e.o,h(e.mds)),a);e=[];for(b=0;b<g.length;b++)l=g[b],Da&&c.getAttribute("ce208")==l.v||e.push(l);if(0<e.length)for(g=0;g<e.length;g++)a.push(e[g]);0<y.length?ya(a,c,ob,null):A(a,c,ob,null)}else h(e.mds)?Sc(e.mds,e.ftr):ob("ce801",e.o)}break;case Q.User:h(e.mds)?Sc(e.mds,e.ftr):ob("ce801",e.o);break;default:throw Error("CL58");}},Sc=function(a,b){F=yb(a,b);var e=[];if(null!=F&&0<F.length){for(var g=0;g<F.length;g++)V(F[g].ID,
a,F[g].Name,e);0<y.length?ya(e,c,ob,null):A(e,c,ob,null)}else ob("ce801",m.Numeric)},ob=function(a,b,e){function g(x,r){if(Y){var B=c;Y=!1}else B=U(c)==n.Name?c:c.nextSibling;B=Pb(B,r);h(B)?Ea(B):Tc(x)}function l(x){var r=null,B=x?m.Date:m.Time;x=x?"":"1/1/2000 ";try{var E=c;if(U(E)!=n.Param||Ba(E)!=B)E=Pb(E,B);h(E)&&(r=new Date(x+E.getAttribute("ce206")));isNaN(r.getDate())&&(r=null);return r}catch(O){return null}}var t=Aa(c);if("ce801"==a)if(a=ud(b),h(a))fa=Y,b=null,0<t.ps.length&&(b=lb(c),0>b&&
(b=0),b=t.ps[b].ftr),Sc(a.Name,b);else switch(parseInt(b,10)){case m.Numeric:fa=!1;oc(Pb(h(c.nextSibling)?c.nextSibling:c,m.Numeric))&&(b=lb(c),b++,g(t,m.Numeric),cb({t:t.t,v:"",st:m.Numeric,ct:u.None,ft:n.Param,pi:b,span:c}));break;case m.String:fa=!1;oc(Pb(h(c.nextSibling)?c.nextSibling:c,m.String))&&(b=lb(c),b++,g(t,m.String),cb({t:t.t,v:"",st:m.String,ct:u.None,ft:n.Param,pi:b,span:c}));break;case m.Date:ka.close();w=3;Ca.show(c,Yd,Uc(t,Ca.defaultFormat()),Y,l(!0));Ca.position();break;case m.Time:ka.close();
w=4;ja.show(c,Zd,Uc(t,ja.defaultFormat()),Y,l(!1));ja.position();break;case m.Enum:a=lb(c)+(Y?0:1);0>a&&(a=0);a<=t.ps.length-1&&(F=Ib(t.ps[a].e),fa=Y);A(F,c,$d,null);break;case m.Bool:fa=Y;A(vd(),c,ae,null);break;case m.Collection:break;default:throw Error("CL62");}else"ce804"==a||"ce805"==a?(Ga="ce805"==a?"ce805":e,Y=!0,A(Ja(),c,ob,null)):(b=yb(b),h(b)?(g(t,m.Numeric),ca({t:t.t,id:null,v:a,n:G(b,a).Name,st:m.Numeric,ct:u.None,ft:n.Param,it:v.Field,h:!1,fv:!1})):(a=G(z.fds,a),g(t,a.o),ca({t:t.t,id:null,
v:a.v,n:a.n,st:a.o,ct:u.None,ft:n.Param,it:v.Field,h:!1,fv:!1})),F=null,c=I(c),ra()&&ib(t))},ae=function(a){wd(a,m.Bool,$b(a))},$d=function(a){wd(a,m.Enum,G(F,a).Name)},wd=function(a,b,e){var g=Pb(Y?c:c.nextSibling,b),l=!1;h(g)&&(ka.close(),Ea(g),l=!0,Y=!1);g=Aa(c);l||Tc(g);ca({t:g.t,id:null,v:a,n:e,st:b,ct:u.None,ft:n.Param,it:v.Input,h:!1,fv:!1});c.setAttribute("ce206",a);c=I(c);ra()&&ib(g)},Yd=function(a){var b=Aa(c);xd(a,b,m.Date,p.formatDate(new Date(a),Uc(b,Ca.defaultFormat())),Ca)},Zd=function(a,
b){xd(a,Aa(c),m.Time,b,ja)},xd=function(a,b,e,g,l){var t=Pb(Y?c:c.nextSibling,e),x=!1;h(t)&&(Ea(t),x=!0,Y=!1);ca({t:b.t,id:null,v:a,n:g,st:e,ct:u.None,ft:n.Param,it:v.Input,h:!1,fv:!1});c=I(c);l.hide();w=0;if(!x)switch(a=Wa(c.nextSibling),U(a)){case n.Param:a=c;ca({t:b.t,id:null,v:"",n:",",st:b.t==d.Action?null:b.rt.o,ct:u.None,ft:n.Comma,it:v.None,h:!1,fv:!1});c=I(a);break;case n.End:case n.Comma:a=c,e=xa(c.previousSibling),U(e)==n.Param&&1<Aa(c).ps.length&&(c=e,ca({t:b.t,id:null,v:"",n:",",st:b.t==
d.Action?null:b.rt.o,ct:u.None,ft:n.Comma,it:v.None,h:!1,fv:!1}),c=I(a))}fa=!1;va();ra()&&ib(b)},Tc=function(a){var b=Wa(c.nextSibling);switch(U(b)){case n.Comma:c=b;Tc(a);break;case n.Param:ca({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:u.None,ft:n.Comma,it:v.None,h:!1,fv:!1});c=I(c.previousSibling);break;case n.End:b=U(c)!=n.None?null:c;var e=xa(c);U(e)==n.Param&&1<Aa(c).ps.length&&(c=I(e),ca({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:u.None,ft:n.Comma,it:v.None,h:!1,
fv:!1}),h(b)&&(c=I(b)))}},lb=function(a){for(var b=-1;h(a)&&U(a)!=n.Name;)U(a)==n.Param&&b++,a=a.previousSibling;return b},Ub=function(a){if(h(a)&&ra())if(D(c)==d.Calculation&&U(c)==n.End)A(Va(),c,Ia,null);else if(a.t==d.Function){var b=Tb(c,n.Name);h(b)?"true"==b.getAttribute("ce216")?A(sa(),c,oa,d.RightParenthesis):A(sb(a),c,nb,null):A(sb(a),c,nb,null)}else a=gc(),0<a.length&&A(a,c,hc,null)},Aa=function(a){a=Tb(a,n.Name);return h(a)?G(D(a)==d.Action?z.acs:z.fds,a.getAttribute("ce208")):null},dd=
function(a,b){for(var e=0,g,l;e<a.length;e++)if(g=a[e],!h(g.Client)||!g.Client){l=new p.StringBuilder;b?h(g.Ns)&&0<g.Ns.length&&(CodeEffects.register(g.Ns),l.append(g.Ns),l.append(".")):l.append("CodeEffects.Rule.");l.append(yd(g.Name));var t=eval(l.dump());h(t);l.append(" = [");if(!h(g.Data)||!g.Data.length||null==g.Data[0])throw Error("Enum or menu data source is empty (CL39)");t=0;for(var x;t<g.Data.length;t++)x=g.Data[t],0<t&&l.append(","),l.append('{"ID":"'),l.append(x.ID),l.append('","Name":"'),
l.append(x.Name),h(x.Filter)&&(l.append('","Filter":"'),l.append(x.Filter)),l.append('"}');l.append("]");eval(l.dump())}},Qc=function(a){switch(a){case 8:case 9:case 16:case 17:case 18:case 19:case 20:case 27:case 127:return!1;default:return!0}},A=function(a,b,e,g,l){ka.close();var t=[];if(h(g)){a:{var x=!0;D(c)!=d.RightSource||h(c.nextSibling)||(x=!1);var r=mb(h(c.nextSibling)?c.nextSibling:c,d.RightSource);h(r)?x&&(r=r.previousSibling):(r=mb(c,d.Flow),h(r)?r=r.previousSibling:(r=$a(),r=r[r.length-
1]));var B=0;x=0;for(var E;h(r);){E=D(r);if(E==d.RightSource){r=Vc(r,d.LeftSource);if(h(r)&&h(r.previousSibling))r=r.previousSibling;else{x=r=0;break a}E=D(r)}if(E==d.Flow||E==d.LeftSource)break;E==d.LeftParenthesis&&B++;E==d.RightParenthesis&&x++;r=h(r.previousSibling)&&D(r.previousSibling)!=d.Flow?r.previousSibling:null}r=B}if(g==d.RightParenthesis&&r>x){if(g=new p.Menu.Item,g.Name=q.els.lbl.pe,g.Type=d.RightParenthesis,t.push(g),a[0].t==d.Clause){g=[];for(r=0;r<a.length;r++)"then"!=a[r].v&&g.push(a[r]);
a=g}}else g==d.LeftParenthesis&&(g=new p.Menu.Item,g.Name=q.els.lbl.pb,g.Type=d.LeftParenthesis,t.push(g))}for(r=0;r<a.length;r++){x=a[r];g=new p.Menu.Item;g.ID=x.v||x.ID;g.Name=x.n||x.Name;if(h(x.t)||h(x.Type))g.Type=x.t||x.Type;t.push(g)}ka.fill(b,t,e,be,q.help?ce:null);fa&&ka.alignLeft(b);fa=!1;w=6;l||(y="")},ya=function(a,b,e,g){a=qd(a,y);if(0<a.length){var l=y;A(a,b,e,g,!0);ka.select(l)}else Ta()},fb=function(a,b){function e(L,Ha){if("ce801"==L)switch(parseInt(Ha,10)){case m.Numeric:cb({t:d.Value,
v:"",st:m.Numeric,ct:u.None,ft:n.None,span:c});break;default:ac(xa(a))}else if("C"==L)Lc(L);else{var ha=G(z.fds,L);ha.t==d.Function?Vb({t:ha.t,m:L,v:!0}):ld(ha,L,!1)}}function g(L){if("ce801"==L){L=t();var Ha=null;L.t==d.Function?h(L.rt.mds)&&(Ha=L.rt.mds):h(L.mds)&&(Ha=L.mds);l(Ha,L.ftr)}else e(L)}function l(L,Ha){F=yb(L,Ha);null!=F&&(fa=Y,A(F,c,Rc,null))}function t(){var L=Ya(c);return h(L)?G(z.fds,L.getAttribute("ce208")):null}function x(L,Ha,ha,wa){for(var na=0;na<L.length;na++){var da=L[na];
da.t!=d.Function&&da.v==ha.v||V(da.v,da.o,da.n,Ha)}0<y.length?ya(Ha,c,wa,null):A(Ha,c,wa,null)}var r=t();if(h(r)){var B=r.t==d.Function?r.rt.ai:r.ai,E=zd(r),O=null;r.t==d.Function?h(r.rt.mds)&&(O=r.rt.mds):h(r.mds)&&(O=r.mds);if(h(O)){var Sa=Wc(E,r);if(B==Q.User||0==Sa.length||1==Sa.length&&Sa[0].v==r.v)l(O,r.ftr);else{var jb=[];0<Sa.length?(B==Q.All&&V("ce801",E,qb(E,!0),jb),x(Sa,jb,r,g)):l(O,r.ftr)}}else B==Q.User?b&&E!=m.Enum&&E!=m.Bool||ac(a):(O=[],Sa=Wc(E,r),0<Sa.length?1==Sa.length&&r.t!=d.Function&&
Sa[0].v==r.v?ac(a):((E==m.Numeric&&r.t==d.Function?r.rt.cal:r.cal)&&V("C",E,q.els.lbl.c,O),B==Q.All&&V("ce801",E,qb(E),O),x(Sa,O,r,e)):b||ac(a))}},ld=function(a,b,e){ca({t:e?d.Calculation:d.Value,id:null,v:a.v,n:a.n,st:a.o,ct:e?u.Field:u.None,ft:n.None,it:v.Field,h:!1,fv:!1});c.setAttribute("ce206",b);ra()&&(e?A(Va(),c,Ia,null):A(sa(),c,oa,d.RightParenthesis))},ac=function(a){function b(e){var g=null;try{var l=c;e=e?"":"1/1/2000 ";D(l)!=d.Value&&(l=mb(l,d.Value));h(l)&&(g=new Date(e+l.getAttribute("ce206")));
isNaN(g.getDate())&&(g=null)}catch(t){g=null}return g}Ta();switch(Ba(a)){case m.String:oc(c.nextSibling)&&cb({t:d.Value,v:"",st:m.String,ct:u.None,ft:n.None,span:null});break;case m.Date:w=3;a=Ya(c);a=h(a)?G(z.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:Ca.defaultFormat();Ca.show(c,de,a,Y,b(!0));Ca.position();break;case m.Time:w=4;a=Ya(c);a=h(a)?G(z.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:ja.defaultFormat();ja.show(c,ee,a,Y,b(!1));ja.position();break;case m.Enum:a=
Ya(a);h(a)&&(D(a)==d.Function?(a=Aa(a),F=Ib(a.rt.e)):(a=G(z.fds,a.getAttribute("ce208")),F=h(a.e)?Ib(a.e):a.ens),P=F,Fb=!1,fa=Y,A(F,c,sd,null));break;case m.Bool:P=vd();Fb=!0;fa=Y;A(P,c,rd,null);break;default:a=Ya(c),a=h(a)?G(z.fds,a.getAttribute("ce208")):null,h(a)&&(a.cal||h(a.rt)&&a.rt.cal)?(a=[],V("C",null,q.els.lbl.c,a),V("ce801",null,qb(m.Numeric),a),A(a,c,Lc,null)):oc(c.nextSibling)&&cb({t:d.Value,v:"",st:m.Numeric,ct:u.None,ft:n.None,span:null})}},pd=function(){if(6==w||3==w||4==w)return!1;
var a=Ya(c);if(!h(a))return!1;a=G(z.fds,a.getAttribute("ce208"));if(a.t==d.Function?a.rt.ai:a.ai!=Q.User){var b=Wc(a.o,a);return 1<b.length&&a.t!=d.Function&&b[0].v!=a.v}return!1},nb=function(a){var b=xa(c),e=Ba(b,!0);tb(hd(a,e),null);ra()?"isNull"==a||"isNotNull"==a?A(sa(),c,oa,d.RightParenthesis):fb(b):ma=!1},Lc=function(a){switch(a){case "C":ca({t:d.LeftBracket,id:null,v:"",n:q.els.lbl.cb,st:null,ct:u.None,ft:n.None,it:v.None,h:!1,fv:!1});a=c;ca({t:d.RightBracket,id:null,v:"",n:q.els.lbl.ce,st:null,
ct:u.None,ft:n.None,it:v.None,h:!1,fv:!1});c=I(a);va();A(Va(),c,Ia,null);break;default:cb({t:d.Value,v:"",st:m.Numeric,ct:u.None,ft:n.None,span:c})}},Ia=function(a,b){if(a==u.Number)a=parseInt(a,10),cb({t:d.Calculation,v:"",st:m.Numeric,ct:a,ft:n.None,span:Wa(c)}),va();else if(a==u.Function){var e=G(z.fds,b);if(!h(e))throw Error("CL46");Vb({t:d.Calculation,m:b,v:!1})}else{a=parseInt(a,10);e="";switch(a){case u.Field:var g=G(z.fds,b);if(!h(g))throw Error("CL48");e=g.v;g=g.n;break;case u.LeftParenthesis:g=
q.els.lbl.pb;break;case u.RightParenthesis:g=q.els.lbl.pe;break;case u.Multiplication:g="&#215;";break;case u.Division:g="&#247;";break;case u.Addition:g="&#43;";break;case u.Subtraction:g="&#150;";break;default:throw Error("CL64");}ca({t:d.Calculation,id:null,v:e,n:g,st:null,ct:a,ft:n.None,it:v.None,h:!1,fv:!1});ra()&&A(Va(),c,Ia,null)}},nd=function(a){var b=[];V(u.Number,null,qb(m.Numeric),b);a=fc(a);for(var e=0;e<a.length;e++)V(a[e].t==d.Function?u.Function:u.Field,a[e].v,a[e].n,b);Y=fa=!0;A(b,
c,Ia,null)},rd=function(a){ca({t:d.Value,id:null,v:a,n:$b(a),st:m.Bool,ct:null,ft:n.None,it:v.None,h:!1,fv:!1});c.setAttribute("ce206",a);ra()&&A(sa(),c,oa,d.RightParenthesis)},sd=function(a){ca({t:d.Value,id:null,v:a,n:G(F,a).Name,st:m.Enum,ct:null,ft:n.None,it:v.None,h:!1,fv:!1});F=null;c.setAttribute("ce206",a);ra()&&A(sa(),c,oa,d.RightParenthesis)},Ka=function(a,b,e){if(h(b)&&parseInt(b,10)==d.LeftParenthesis)ca({t:d.LeftParenthesis,id:null,v:"(",n:q.els.lbl.pb,st:null,ct:u.None,ft:n.None,it:v.None,
h:!1,fv:!1}),ra()&&A(Ja(),c,Ka,d.LeftParenthesis);else switch(a){case "ce802":case "ce803":Ga=null;b=[];for(e=0;e<z.fds.length;e++){var g=z.fds[e];g.t==d.Field&&g.o==m.Collection&&g.ct==H.Reference&&b.push(g)}e=[];for(g=0;g<b.length;g++)V(a,b[g].v,b[g].n,e);A(e,c,fe,null);break;case "ce804":Ga=e;A(Ja(),c,Ka,null);Za&&(Ga=e);break;case "ce805":Ga="ce805";A(Ja(),c,Ka,null);Za&&(Ga="ce805");break;default:Ga=null,b=G(z.fds,a),b.t==d.Function?Vb({t:b.t,m:a,v:!1}):(tb(b,null),ra()&&A(sb(b),c,nb,null))}},
Rc=function(a){ca({t:d.Value,id:null,v:a,n:G(F,a).Name,st:m.Numeric,ct:u.None,ft:n.None,it:v.Field,h:!1,fv:!1});F=null;c.setAttribute("ce206",a);ra()&&A(sa(),c,oa,d.RightParenthesis)},fe=function(a,b){var e=G(z.fds,b);ca({t:d.Exists,id:null,v:a,n:Ec(a),st:null,ct:null,ft:n.None,it:v.None,h:!1,fv:!1});tb(e,null);ca({t:d.Where,id:null,v:a,n:Jb(q.els.dsc,"where"),st:null,ct:null,ft:n.None,it:v.None,h:!1,fv:!1});ca({t:d.LeftSource,id:null,v:e.cv,n:q.els.lbl.ub,st:null,ct:u.None,ft:n.None,it:v.None,h:!1,
fv:!1});e=c;ca({t:d.RightSource,id:null,v:z.n,n:q.els.lbl.ue,st:null,ct:u.None,ft:n.None,it:v.None,h:!1,fv:!1});c=I(e);aa(c);A(Ja(),c,Ka,d.LeftParenthesis)},Pc=function(a){Y=!0;a=G(z.fds,a);var b=mb(c,d.Field);c=I(b);tb(a,null)},Wd=function(a){Y=!0;ca({t:d.Exists,id:null,v:a,n:Ec(a),st:null,ct:null,ft:n.None,it:v.None,h:!1,fv:!1})},Ob=function(a,b,e){switch(a){case "ce804":Ga=e;A(Nb(),c,Ob,null);Za&&(Ga=e);break;case "ce805":Ga="ce805";A(Nb(),c,Ob,null);Za&&(Ga="ce805");break;default:a=G(z.fds,a),
tb(a,null),ca({t:d.Setter,id:null,v:"to",n:Jb(q.els.str,"to"),st:a.o,ct:null,ft:n.None,it:v.None,h:!1,fv:!1}),ra()?fb(xa(c)):ma=!1}},oa=function(a,b){"else"==a||"elseIf"==a?hc(a):h(b)&&parseInt(b,10)==d.RightParenthesis?(ca({t:d.RightParenthesis,id:null,v:")",n:q.els.lbl.pe,st:null,ct:u.None,ft:n.None,it:v.None,h:!1,fv:!1}),ra()&&A(sa(),c,oa,d.RightParenthesis)):(tb(G(q.els.cls,a),null),("then"==a||ab(c))&&ra()?A(db(),c,eb,null):ra()&&A(Ja(),c,Ka,d.LeftParenthesis))},de=function(a){var b=Ya(c);b=
h(b)?G(z.fds,b.getAttribute("ce208")):null;b=h(b)?h(b.rt)?b.rt.f:b.f:Ca.defaultFormat();var e=!0,g=Wa(c);h(g)&&D(g)==d.Value&&Ba(g)==m.Date&&(c=I(g),e=!1);e?ca({t:d.Value,id:null,v:a,n:p.formatDate(new Date(a),b),st:m.Date,ct:null,ft:n.None,it:v.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),p.text(c,p.formatDate(new Date(a),b)));Ca.hide();fa=!1;w=0;va();ra()&&A(sa(),c,oa,d.RightParenthesis)},ee=function(a,b){var e=!0;if(h(c.nextSibling)){var g=Wa(c.nextSibling);h(g)&&D(g)==d.Value&&Ba(g)==m.Time&&
(c=I(g),e=!1)}e?ca({t:d.Value,id:null,v:a,n:b,st:m.Time,ct:null,ft:n.None,it:v.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),p.text(c,b));ja.hide();fa=!1;w=0;va();ra()&&A(sa(),c,oa,d.RightParenthesis)},eb=function(a){"set"==a?(ca({t:d.Setter,id:null,v:"set",n:Jb(q.els.str,"set"),st:null,ct:null,ft:n.None,it:v.None,h:!1,fv:!1}),ra()?A(Nb(),c,Ob,null):ma=!1):Vb({t:G(z.acs,a).t,m:a,v:!1})},hc=function(a){var b="and"==a;tb(G(b?q.els.cls:q.els.fls,a),null);ra()&&(b?A(db(),c,eb,null):"else"==a?A(db(),c,
eb,null):A(Ja(),c,Ka,d.LeftParenthesis))},ca=function(a,b){b=void 0===b?!0:b;var e=new p.Client.Element;e.n=a.n;e.v=a.v;e.t=a.t;e.o=h(a.st)?a.st:m.None;e.CalType=h(a.ct)?a.ct:u.None;e.FuncType=h(a.ft)?a.ft:n.None;e.q=a.fv;e.InpType=h(a.it)?a.it:v.None;tb(e,a.id,a.h,b)},tb=function(a,b,e,g){b=void 0===b?null:b;e=void 0===e?!1:e;g=void 0===g?!0:g;var l=!(!h(c)||!h(c.nextSibling));var t=document.createElement("SPAN");t.id=h(b)?b:C.container.id+Xa;Xa++;99999999999<Xa&&(Xa=0);wb=g;t.setAttribute("ce218",
"false");a.t==d.Field&&a.o==m.Collection?(b=G(z.fds,a.v),b.ct==H.Reference?h(b.cn)?t.innerHTML=b.cn:t.innerHTML=a.n:t.innerHTML=a.n):t.innerHTML=a.n;a.t==d.Value?(za(t,"ceValue"),t.setAttribute("ce206",a.v)):a.t==d.Calculation?(a.CalType==u.Function?a.FuncType==n.Name||a.FuncType==n.End?za(t,"ceMethod"):a.FuncType==n.Param?a.InpType==v.Field?za(t,"ceFieldInput"):za(t,"ceValue"):za(t,"ceValue"):a.CalType==u.RightParenthesis?(t.onmouseover=function(x){pc(this,Ad)},t.onmouseout=function(x){qc(this,Ad)},
za(t,"ceParenthesis"),t.style.paddingRight=t.style.paddingLeft="2px"):a.CalType==u.LeftParenthesis?(t.onmouseover=function(x){pc(this,Bd)},t.onmouseout=function(x){qc(this,Bd)},za(t,"ceParenthesis"),t.style.paddingRight=t.style.paddingLeft="2px"):za(t,"ceValue"),h(a.v)&&t.setAttribute("ce206",a.v)):a.t==d.Flow?za(t,"ceFlow"):a.t==d.Field?za(t,"ceField"):a.t==d.Function?a.FuncType==n.Name||a.FuncType==n.End?(t.setAttribute("ce216",a.q?"true":"false"),za(t,"ceMethod")):(a.FuncType==n.Param?a.InpType==
v.Field?za(t,"ceFieldInput"):za(t,"ceValue"):za(t,"ceValue"),a.InpType==v.Input&&h(a.v)&&t.setAttribute("ce206",a.v)):a.t==d.Action?a.FuncType==n.Name||a.FuncType==n.End?za(t,"ceAction"):(a.FuncType==n.Param?a.InpType==v.Field?za(t,"ceFieldInput"):za(t,"ceValue"):za(t,"ceValue"),a.InpType==v.Input&&h(a.v)&&t.setAttribute("ce206",a.v)):a.t==d.Operator?za(t,"ceOperator"):a.t==d.LeftBracket||a.t==d.RightBracket?za(t,"ceParenthesis"):a.t==d.LeftSource||a.t==d.RightSource?za(t,"ceBrace"):a.t==d.Clause||
a.t==d.Setter||a.t==d.Where||a.t==d.Exists?za(t,"ceClause"):a.t==d.Tab?za(t,"ceTab"):a.t==d.NewLine&&za(t,"ceNewLine");a.t==d.Tab?t.style.paddingRight=t.style.paddingLeft="8px":a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End?(a.t==d.RightParenthesis?(t.onmouseover=function(x){pc(this,Cd)},t.onmouseout=function(x){qc(this,Cd)},t.className="ceParenthesis"):a.t==d.LeftParenthesis&&(t.onmouseover=function(x){pc(this,Dd)},t.onmouseout=function(x){qc(this,Dd)},t.className="ceParenthesis"),
t.style.paddingRight=t.style.paddingLeft="2px"):(b=G(a.t==d.Action?z.acs:z.fds,a.v),h(b)&&h(b.ps)&&0!=b.ps.length||(t.style.paddingRight=t.style.paddingLeft="0",t.style.width="2px"));t.style.paddingBottom="2px";t.style.display="inline-block";t.style.whiteSpace="nowrap";t.setAttribute("ce202",a.t);a.t==d.Field&&a.o==m.Bool&&(a.ir?t.setAttribute("ce213","true"):(b=G(z.fds,a.v),h(b)&&h(b.ir)&&b.ir&&t.setAttribute("ce213","true")));t.setAttribute("ce203",h(a.CalType)?a.CalType:u.None);t.setAttribute("ce204",
h(a.FuncType)?a.FuncType:n.None);t.setAttribute("ce205",h(a.InpType)?a.InpType:v.None);t.setAttribute("ce208",a.v);h(a.o)&&a.o!=m.None?t.setAttribute("ce209",a.o):t.setAttribute("ce209",m.None);Y&&pb();Y=!1;if(l){if(l=c.nextSibling,C.container.insertBefore(t,c.nextSibling),a.t!=d.Tab){if(h(l)&&D(l)==d.Tab)for(;h(l)&&D(l)==d.Tab;)b=l.nextSibling,C.container.removeChild(l),l=b;if(h(l)){if(a.t==d.RightBracket&&D(l)==d.LeftBracket){for(;D(l)!=d.RightBracket;)b=l.nextSibling,C.container.removeChild(l),
l=b;C.container.removeChild(l)}a.t!=d.Calculation||a.CalType!=u.Field&&a.CalType!=u.Number?(a.t==d.Value||a.t==d.Operator&&"isNull"!=a.v&&"isNotNull"!=a.v||a.t==d.Clause&&"then"==a.v||a.t==d.Flow&&"else"==a.v)&&a.t==D(l)&&a.o==Ba(l)&&C.container.removeChild(l):a.t==D(l)&&ge(a.CalType,qa(l))&&C.container.removeChild(l)}}}else C.container.appendChild(t);a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End||!Pa(t)?c=e?t:I(t):hb(t,e);q.titles&&he(a);Da=!1;va()},cb=function(a){Ta();var b=
xa(h(a.span)?a.span:c),e=document.createElement("INPUT");e.type="text";e.id=C.container.id+Xa;Xa++;99999999999<Xa&&(Xa=0);e.className="ceValue";e.style.marginRight=e.style.marginLeft="2px";e.style.width="2px";var g=Ya(b);b=null;h(g)&&(b=G(z.fds,g.getAttribute("ce208")),h(b)||(b=G(z.acs,g.getAttribute("ce208"))));if(h(b)){g=-9007199254740992;var l=null,t=null;b.t==d.Function||b.t==d.Action?a.ft==n.Param?h(a.pi)&&h(b.ps[a.pi])&&(g=h(b.ps[a.pi].min)?b.ps[a.pi].min:g,h(b.ps[a.pi].max)&&(l=b.ps[a.pi].max),
t=h(b.ps[a.pi].dec)?b.ps[a.pi].dec:!0):(g=h(b.rt.min)?b.rt.min:g,h(b.rt.max)&&(l=b.rt.max),t=h(b.rt.dec)?b.rt.dec:!0):(g=h(b.min)?b.min:g,h(b.max)&&(l=b.max),t=h(b.dec)?b.dec:!0);a.st==m.Numeric?(e.maxLength=28,e.setAttribute("ce212",h(l)?l.toString():(-1*g).toString()),e.setAttribute("ce211",g.toString()),e.setAttribute("ce214",t?"1":"0"),e.setAttribute("ce215",0>g?"1":"0")):(e.maxLength=h(l)?l:256,e.setAttribute("ce212",e.maxLength.toString()))}else e.maxLength=256,e.setAttribute("ce212",e.maxLength.toString());
h(a.span)?D(a.span)==d.Value||D(a.span)==d.Calculation&&qa(a.span)==u.Number||(D(a.span)==d.Function||D(a.span)==d.Action)&&Ua(a.span)==v.Input?(ub=a.span.id,a.span.style.display="none",C.container.insertBefore(e,a.span)):(ub=null,h(a.span.nextSibling)?C.container.insertBefore(e,a.span.nextSibling):C.container.appendChild(e)):h(c)&&h(c.nextSibling)?C.container.insertBefore(e,c.nextSibling):(ub=null,C.container.appendChild(e));e.setAttribute("ce202",a.t);e.setAttribute("ce209",h(a.st)?a.st:m.None);
e.setAttribute("ce206",a.v);e.setAttribute("ce203",h(a.ct)?a.ct:u.None);e.setAttribute("ce204",h(a.ft)?a.ft:n.None);e.setAttribute("ce205",v.Input);e.setAttribute("ce208",a.v);Ed(e);w=0;e.value=h(a.v)?p.decode(a.v):"";0<e.value.length&&Cb(e);if(0==e.value.length)try{e.focus()}catch(x){}else try{e.select()}catch(x){}e.onkeydown=function(x){x=new p.Event(x);var r=Ba(this);if(r==m.Numeric&&32==x.keyCode)return Sb(q.els.er.e112),x.preventDefault(),!1;if(8==x.keyCode||32==x.keyCode||127==x.keyCode||37==
x.keyCode||39==x.keyCode)return!0;if(r==m.Numeric){r=x.keyCode;var B="1"==this.getAttribute("ce214"),E="1"==this.getAttribute("ce215");if(!B&&(188==r||190==r||110==r))return Sb(q.els.er.e110),x.preventDefault(),!1;if(!E&&(109==r||189==r))return Sb(q.els.er.e111),x.preventDefault(),!1;E="";switch(r){case 188:case 190:case 110:var O=188==r?",":".";if(0==this.value.length)return this.value="0"+O,Cb(this,x.keyCode),x.preventDefault(),!1;-1<this.value.indexOf(",")||-1<this.value.indexOf(".")?Sb(q.els.er.e113):
(this.value+=O,this.value=="-"+O&&(this.value="-0"+O),1<this.value.length&&"0"==this.value.substr(0,1)&&this.value.substr(1,1)!=O&&(this.value=this.value.substr(1)),2<this.value.length&&"-0"==this.value.substr(0,2)&&this.value.substr(2,1)!=O&&(this.value="-"+this.value.substr(2)));x.preventDefault();return!1;case 109:case 189:return 0==this.value.length?(this.value="-",Cb(this,109)):0>this.value.indexOf("-")&&(this.value="-"+this.value,Cb(this,109)),x.preventDefault(),!1;default:if(O=x.rawEvent.key||
x.rawEvent["char"])switch(r){case 48:"0"!=O&&(E=O);break;case 49:"1"!=O&&(E=O);break;case 50:"2"!=O&&(E=O);break;case 51:"3"!=O&&(E=O);break;case 52:"4"!=O&&(E=O);break;case 53:"5"!=O&&(E=O);break;case 54:"6"!=O&&(E=O);break;case 55:"7"!=O&&(E=O);break;case 56:"8"!=O&&(E=O);break;case 57:"9"!=O&&(E=O)}1>E.length&&(96<=r&&105>=r&&(r-=48),E=this.value.replace(",",".")+String.fromCharCode(r),1<E.length&&"0"==E.substr(0,1)&&"."!=E.substr(1,1)&&(this.value=this.value.substr(1,1),E=E.substr(1,1)),2<E.length&&
"-0"==E.substr(0,2)&&"."!=E.substr(2,1)&&(this.value="-"+this.value.substr(2),E="-"+E.substr(2)))}if(B&&!p.isNumeric(E)||!B&&!p.isInteger(E))return Sb(q.els.er.e112),Cb(this),x.preventDefault(),!1}Cb(this,x.keyCode);Ra()};e.onkeyup=function(x){x=new p.Event(x);8!=x.keyCode&&32!=x.keyCode&&127!=x.keyCode||Cb(this);this.setAttribute("ce206",this.value)};e.onpaste=function(x){if(Ba(this)==m.Numeric)return!1;var r=this;setTimeout(function(){Cb(r)},60)};e.onblur=function(x){Oa()}},Cb=function(a,b){if(!(h(b)&&
a.value.length>=a.maxLength)){var e=document.createElement("SPAN");e.id="ceTxt"+C.container.id;e.className="ceValue";e.style.whiteSpace="nowrap";C.container.appendChild(e);e.innerHTML=$rule.encode(a.value+(h(b)?String.fromCharCode(b):""));var g=gb(e).width;C.container.removeChild(e);a.style.width=g+2+"px"}},he=function(a){function b(g){g=G(z.fds,g);h(g)&&h(g.d)&&(c.title=Zb(g.d))}switch(a.t){case d.Function:case d.Action:switch(a.FuncType){case n.Name:a=G(a.t==d.Function?z.fds:z.acs,a.v);h(a)&&h(a.d)&&
(c.title=Zb(a.d));break;case n.Param:if(a=Aa(c),h(a)&&0<a.ps.length){var e=lb(c);0<=e&&(a=a.ps[e],h(a)&&h(a.d)&&(c.title=Zb(a.d)))}}break;case d.Field:b(a.v);break;case d.Value:a.InpType==v.Field&&b(a.v);break;case d.Calculation:a.CalType==u.Field&&b(a.v)}},pb=function(){D(c)==d.HtmlTag&&(c=I(h(c.nextSibling)?c.nextSibling:c.previousSibling),aa(c));switch(D(c)){case d.Calculation:case d.Function:case d.Action:switch(U(c)){case n.Name:for(;U(c)!=n.End;){var a=c.nextSibling;C.container.removeChild(c);
c=a}Ea(c);break;case n.End:for(;U(c)!=n.Name;)Ea(c);Ea(c);break;case n.Comma:for(Ea(c);U(c)!=n.Name&&U(c)!=n.Comma;)Ea(c);break;case n.Param:a=Wa(c.nextSibling);if(U(a)==n.Comma)c=a,pb();else for(Ea(c);U(c)!=n.Name&&U(c)!=n.Param;)Ea(c);break;default:Ea(c)}break;case d.Field:a=G(z.fds,c.getAttribute("ce208"));h(a)&&a.o==m.Collection&&a.ct==H.Reference?Fd(c):Ea(c);break;case d.LeftBracket:if(!h(c.nextSibling))throw Error("CL82");for(;D(c)!=d.RightBracket;)a=c.nextSibling,C.container.removeChild(c),
c=a;Ea(c);break;case d.RightBracket:if(!h(c.previousSibling))throw Error("CL84");for(;D(c)!=d.LeftBracket;)Ea(c);Ea(c);break;case d.RightSource:case d.LeftSource:case d.Where:case d.Exists:Fd(c);break;default:Ea(c)}va()},Fd=function(a){if(!Y){a=D(c)==d.RightSource?c:Gd(c,d.RightSource);if(!h(a)){Ea(c);return}for(var b=Vc(a,d.Exists).id,e;a.id!=b;)e=a.previousSibling,C.container.removeChild(a),a=e;c=I(a)}Ea(c)},Ea=function(a){if(h(a.previousSibling)){var b=a.previousSibling;C.container.removeChild(a);
c=I(b);wb=!0;aa(c)}},pc=function(a,b){if(!rc(a)){var e=b(a);if(h(e)){if(1==w||a.id!=c.id)a.className+=" ceHighlight";rc(e)||1!=w&&e.id==c.id||(e.className+=" ceHighlight")}}},qc=function(a,b){if(!rc(a)){var e=b(a);if(h(e)){if(1==w||a.id!=c.id)a.className=$rule.trim(a.className.replace("ceHighlight",""));rc(e)||1!=w&&e.id==c.id||(e.className=$rule.trim(e.className.replace("ceHighlight","")))}}},rc=function(a){if(!h(W)||0==W.length)return!1;for(var b=0;b<W.length;b++)if(W[b]==a.id)return!0;return!1},
Cd=function(a){var b=1;a=a.previousSibling;for(var e;h(a);){e=D(a);if(e==d.RightSource)if(a=Vc(a,d.LeftSource),h(a)&&h(a.previousSibling))a=a.previousSibling,e=D(a);else{a=null;break}e==d.RightParenthesis?b++:e==d.LeftParenthesis&&b--;if(0==b)break;else if(e==d.LeftSource||e==d.Flow){a=null;break}else a=a.previousSibling}return h(a)?a:null},Dd=function(a){var b=1;a=a.nextSibling;for(var e;h(a);){e=D(a);if(e==d.LeftSource)if(a=Gd(a,d.RightSource),h(a)&&h(a.nextSibling))a=a.nextSibling,e=D(a);else{a=
null;break}e==d.RightParenthesis?b--:e==d.LeftParenthesis&&b++;if(0==b)break;else if(e==d.RightSource||e==d.Flow){a=null;break}else a=a.nextSibling}return h(a)?a:null},Ad=function(a){var b=1;for(a=a.previousSibling;h(a)&&(qa(a)==u.LeftParenthesis?b--:qa(a)==u.RightParenthesis&&b++,0!=b);)a=a.previousSibling;return h(a)&&D(a)!=d.LeftBracket?a:null},Bd=function(a){var b=1;for(a=a.nextSibling;D(a)!=d.RightBracket&&(qa(a)==u.RightParenthesis?b--:qa(a)==u.LeftParenthesis&&b++,0!=b);)a=a.nextSibling;return h(a)&&
D(a)!=d.RightBracket?a:null},Vc=function(a,b){for(var e=0,g=0,l;h(a);){l=D(a);l==d.LeftSource&&e++;if(e==g&&l==b)return a;l==d.RightSource&&g++;a=h(a.previousSibling)&&D(a.previousSibling)!=d.Flow?a.previousSibling:null}return null},Gd=function(a,b){for(var e=0,g=0,l;h(a);){l=D(a);l==d.RightSource&&g++;if(e==g&&l==b)return a;l==d.LeftSource&&e++;a=h(a.nextSibling)&&D(a.nextSibling)!=d.Flow?a.nextSibling:null}return null},xb=function(a,b){if(!h(c.nextSibling)||D(c.nextSibling)!=d.HtmlTag||!h(c.nextSibling.nextSibling.nextSibling)||
D(c.nextSibling.nextSibling.nextSibling)!=d.HtmlTag){var e=document.createElement("BR");e.setAttribute("ce202",d.HtmlTag);h(c)&&h(c.nextSibling)||a?C.container.insertBefore(e,a?c:c.nextSibling):C.container.appendChild(e);c=b?e:I(e);ca({t:d.NewLine,id:null,v:"",n:q.tochki?"&#149;&nbsp;":"&nbsp;&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:b})}},td=function(){fd();q.help&&Kb(q.els.ms.i101);Na=0;y="";Za=!1;w=2;aa(null)},bd=function(){if(h(C)&&h(C.container)&&h(q)){6!=w&&8!=w||Ta();td();if(q.tools){T.setValue("");
T.setClass("ceNameBoxDefault");X.setValue("");X.setClass("ceDescriptionBoxDefault");var a=p.getChildrenByAttribute(J,"ce235");0<a.length&&a[0].parentNode.removeChild(a[0])}Fa=null;w=1}},oc=function(a){if(h(a)&&(a=Wa(a),h(a))){var b=Ba(a);if(zb(D(a),b,qa(a),Ua(a))&&Ua(a)!=v.Field)return b!=m.String&&b!=m.Numeric&&Ed(a),c=I(c),Y=fa=!1,va(),!1}return!0},Cc=function(){if(h(W)&&0<W.length){for(var a,b=0;b<W.length;b++)a=document.getElementById(W[b]),h(a)&&(a.className=$rule.trim(a.className.replace("ceHighlight",
"")),a.title="");W=[]}q.help&&(M.className=$rule.trim(M.className.replace("ceError","")))},ic=function(){ia=null;for(var a=p.getChildrenByAttribute(C.container,"ce218","true"),b,e=0;e<a.length;e++)b=a[e],b.className=p.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218","false")},od=function(a,b){S=[];sibling=null;var e=p.getChildrenByAttribute(C.container,"ce218","true");if(0<e.length){for(var g=!1,l=!1,t=0,x,r;t<e.length;t++){x=e[t];r=D(x);f=U(x);switch(r){case d.HtmlTag:g=!0;break;
case d.NewLine:case d.Tab:if(!g)continue;break;default:g=!1}switch(r){case d.Function:case d.Action:if(f==n.Name)l=!0;else if(!l)continue;break;case d.Calculation:if(f==n.Name)l=!0;else if(f==n.None||l)l=!1;else continue;break;default:l=!1}a&&h(x.previousSibling)&&(sibling=x.previousSibling,r=D(sibling),r==d.HtmlTag||r==d.NewLine)&&(sibling=sibling.previousSibling);r=a?C.container.removeChild(x):x.cloneNode(!0);r.className=p.trim(x.className.replace("ceSelected",""));r.setAttribute("ce218","false");
S.push(r)}a&&h(sibling)&&(c=I(sibling));Ra(b,e.length)}},Jd=function(a){a="ceT"+C.container.id;J=document.getElementById(a);h(J)&&J.parentNode.removeChild(J);J=document.createElement("DIV");J.id=a;J.className="ceToolBar";a=document.createElement("DIV");a.className="ceContainer";J.appendChild(a);var b=document.createElement("DIV");b.className="ceRulesMenu";a.appendChild(b);Qa=document.createElement("SPAN");Qa.id="ceRl"+C.container.id;Qa.className="ceRulesButton";Qa.innerHTML=q.els.lbl.r+"&nbsp;&#9662;";
b.appendChild(Qa);Qa.onclick=function(g){aa(null);(new p.Event(g)).stopPropagation();Rb();fa=!0;0<y.length?ya(Z,Qa,mc,null):A(Z,Qa,mc,null);w=8};b=document.createElement("DIV");b.className="ceControls";b.setAttribute("ce234","true");a.appendChild(b);var e=document.createElement("DIV");e.className="ceInputName";b.appendChild(e);T=new p.TextBox.Control;T.init(new p.TextBox.Settings(e,"ceTl"+C.container.id,"ceNameBox","ceNameBoxDefault",50,q.els.lbl.n,q.els.er.e104,"ceError"));e=document.createElement("DIV");
e.className="ceInputDesc";b.appendChild(e);X=new p.TextBox.Control;X.init(new p.TextBox.Settings(e,"ceTd"+C.container.id,"ceDescriptionBox","ceDescriptionBoxDefault",80,q.els.lbl.d,q.els.er.e104,"ceError"));e=document.createElement("DIV");e.className="ceSave";b.appendChild(e);b=document.createElement("SPAN");b.className="ceSaveButton";b.innerHTML=q.els.lbl.a;e.appendChild(b);b.onclick=function(g){6!=w&&8!=w||Ta();g=$a();0!=g.length&&(1!=g.length||h(D(g[0]))&&D(g[0])!=d.Flow)?Xc("ceSave"):alert(q.els.er.e106)};
J.appendChild(a);C.container.appendChild(J)},ed=function(){var a=document.getElementById("ceH"+C.container.id);h(a)&&a.parentNode.removeChild(a);M=null;q.help=!1},Xc=function(a){Hb=a;aa(null);if(C.clientOnly)switch(Hb){case "ceDelete":if(!h(Fa))throw Error("CL31");if(!h(yc)){alert("The Delete action is not defined");break}vb=!0;yc(Fa);break;case "ceSave":if(!h(xc)){alert("The Save action is not defined");break}vb=!1;xc(Gb.serialize(dc()));break;default:h(zc)?(vb=!0,zc(a)):alert("The Load action is not defined")}else if(C.asp){vb=
"ceSave"!=Hb;try{eval(q.pb+"('"+C.id+"','')")}catch(e){alert("Unexpected order of elements (CL81)")}}else switch(Hb){case "ceDelete":if(!h(Fa))throw Error("CL32");q.pb&&q.pb.d?window.location=q.pb.d.replace("_ce_",Fa):alert("The Delete action is not defined");break;case "ceSave":if(!h(C.fieldId))throw Error("CL33");if(q.pb&&q.pb.s)if(h(C.form))Dc(),C.form.action?C.form.action=q.pb.s:C.form.setAttribute("action",q.pb.s),C.form.submit();else{a=document.createElement("FORM");document.body.appendChild(a);
a.setAttribute("ce","form"+C.container.id);a.action?a.action=q.pb.s:a.setAttribute("action",q.pb.s);a.method?a.method="post":a.setAttribute("method","post");var b=document.createElement("INPUT");b.type="hidden";b.id=C.fieldId;b.name=C.id;vb=!1;b.value=Gb.serialize(dc());a.appendChild(b);a.submit()}else alert("The Save action is not defined");break;default:q.pb&&q.pb.l?window.location=q.pb.l.replace("_ce_",Hb):alert("The Load action is not defined")}},ce=function(a){if(q.help){var b=G(z.fds,a),e=null;
h(b)?b.d&&(e=b.d):(b=G(z.acs,a),h(b)&&b.d?e=b.d:(b=G(q.els.rls,a),h(b)&&b.d&&(e=b.d)));h(e)&&0<e.length?Kb(e):Ra()}},mc=function(a){"ceEval"==a||"ceExec"==a?(wb=!1,q.isEval="ceEval"==a,bd()):(ka.close(),w=1,Xc(a))},$c=function(){if(!(0<p.getChildrenByAttribute(J,"ce235").length)){var a=document.createElement("DIV");a.setAttribute("ce235","true");a.className="ceDelete";var b=document.createElement("SPAN");b.className="ceDeleteButton";b.innerHTML=q.els.lbl.u;a.appendChild(b);p.getChildrenByAttribute(J,
"ce234")[0].appendChild(a);b.onclick=function(e){confirm(q.els.er.e105)&&Xc("ceDelete")}}},Ib=function(a){a=eval(yd(a));return h(a.ce)?a.ce:a},G=function(a,b){if(h(a))for(var e,g=0;g<a.length;g++)if(e=a[g],h(e.v)&&e.v==b||h(e.ID)&&e.ID==b)return e;return null},Ja=function(){var a=[];if(z.references){V("ce802",d.Field,q.els.lbl.h,a);V("ce803",d.Field,q.els.lbl.l,a);for(var b=0;b<z.fds.length;b++){var e=z.fds[b];if(e.t==d.Field&&e.o==m.Collection){if(e.ct==H.Generic)throw Error("CL83");e.ct!=H.Reference&&
a.push(e)}else a.push(e)}}else a=z.fds;var g=h(Fa),l=[],t=h(Ga);for(b=0;b<a.length;b++)if(e=a[b],!h(e.gtb)||e.gtb)if(!e.ir||!g||e.v!=Fa){if(t)if(h(e.grp))if("ce805"==Ga)continue;else{if(e.grp!=Ga)continue}else if("ce805"!=Ga)continue;l.push(e)}return Hd(l,z.references)},Hd=function(a,b){function e(r,B){return r.Name.localeCompare(B.Name)}if(h(Ga))return Ga=null,a;for(var g=[],l=!1,t=0,x;t<a.length;t++)x=a[t],h(x.grp)?ie(g,x.grp)||g.push({ID:"ce804",Name:x.grp}):l=!0;if(0<g.length){x=[];b&&(x.push(a[0]),
x.push(a[1]));g.sort(e);for(t=0;t<g.length;t++)x.push(g[t]);l&&x.push({ID:"ce805",Name:q.els.lbl.eg});return x}return a},ie=function(a,b){for(var e=0;e<a.length;e++)if(a[e].Name==b)return!0;return!1},Nb=function(){for(var a=[],b=h(Ga),e,g=0;g<z.fds.length;g++)if(e=z.fds[g],!(e.ir||e.t==d.Function||e.o==m.Collection||h(e.st)&&!e.st)){if(b)if(h(e.grp))if("ce805"==Ga)continue;else{if(e.grp!=Ga)continue}else if("ce805"!=Ga)continue;a.push(e)}return Hd(a,!1)},Oc=function(a){for(var b=[],e=G(z.fds,a),g=
0;g<z.fds.length;g++)a=z.fds[g],a.v!=e.v&&a.o==m.Collection&&a.ct==H.Reference&&a.cc==e.cc&&a.cl==e.cl&&a.cv==e.cv&&b.push(a);return b},db=function(){for(var a=[],b=!1,e=0,g;e<z.fds.length;e++)if(g=z.fds[e],g.o!=m.Collection&&g.t!=d.Function&&!g.ir&&(!h(g.st)||g.st)){b=!0;break}b&&V("set",null,q.els.lbl.w,a);for(e=0;e<z.acs.length;e++)a.push(z.acs[e]);return a},sa=function(){if(ab(c))return gc();var a=[];var b=0;for(var e=c,g;h(e);){g=D(e);if(g==d.Flow)break;g==d.LeftSource?b--:g==d.RightSource&&
b++;e=h(e.previousSibling)&&D(e.previousSibling)!=d.Flow?e.previousSibling:null}b=0==b;for(g=0;g<q.els.cls.length;g++)e=q.els.cls[g],(!q.isEval&&b||"then"!=e.v)&&a.push(e);return a},Vd=function(a){for(var b=[],e,g=0;g<q.els.cls.length;g++)e=q.els.cls[g],"then"!=e.v&&e.v!=a&&b.push(e);return b},hd=function(a,b){for(var e=0;e<q.els.ops.length;e++)if(q.els.ops[e].v==a&&q.els.ops[e].o==b)return q.els.ops[e];return null},sb=function(a,b){var e=[];if(a.t==d.Function){var g=a.rt.o;var l=a.rt.l;var t=h(a.rt.mds)}else a.ir?
(l=t=!1,g=m.Bool):(l=a.l,g=a.o,t=h(a.mds));for(var x=0;x<q.els.ops.length;x++){var r=q.els.ops[x];if(r.o==g&&(!h(b)||r.v!=b)&&(l||"isNull"!=r.v&&"isNotNull"!=r.v)){if(g==m.Numeric&&t)if(l){if("isNull"!=r.v&&"isNotNull"!=r.v&&"equal"!=r.v&&"notEqual"!=r.v)continue}else if("equal"!=r.v&&"notEqual"!=r.v)continue;e.push(r)}}return e},vd=function(){var a=[];V("true",null,q.els.lbl.t,a);V("false",null,q.els.lbl.f,a);return a},Wc=function(a,b){var e=[];ab(c);for(var g,l,t,x,r=b.t==d.Function?b.rt.e:b.e,
B=b.t==d.Function?b.rt.mds:b.mds,E=0;E<z.fds.length;E++)if(g=z.fds[E],g.o!=m.Collection&&(l=zd(g),x=g.t==d.Function?g.rt.e:g.e,t=g.t==d.Function?g.rt.mds:g.mds,l!=m.Enum||h(r)&&r==x))l!=a||g.ir||(h(t)?h(B)&&t==B&&e.push(g):h(B)||h(b.ftr)&&"any"!=b.ftr&&"any"!=g.ftr&&b.ftr!=g.ftr||e.push(g));return e},fc=function(a){var b=null;if(h(a))e=G(z.fds,a),h(e)&&h(e.ftr)&&(b=e.ftr);else if(e=Ya(c),h(e)){var e=G(z.fds,e.getAttribute("ce208"));h(e)&&h(e.ftr)&&(b=e.ftr)}e=[];for(var g,l=0,t;l<z.fds.length;l++)g=
z.fds[l],t=h(g.ftr)?g.ftr:null,(g.t!=d.Field||g.ir||h(g.mds)||g.o!=m.Numeric||!g.i||h(a)&&g.v==a||null!=b&&"any"!=b&&b!=t&&"any"!=t)&&(g.t!=d.Function||g.rt.o!=m.Numeric||!g.i||h(a)&&g.v==a||null!=b&&"any"!=b&&b!=t&&"any"!=t)||e.push(g);return e},yb=function(a,b){var e=ud(a),g=null;null!=e&&(g=e.Client?eval(e.Data[0]+"()"):eval("CodeEffects.Rule."+a));if(h(b)){e=[];for(var l=0,t;l<g.length;l++)t=g[l],h(t.Filter)&&"any"!=b&&"any"!=t.Filter&&t.Filter!=b||e.push(t);return e}return g},ud=function(a){if(!h(q.els.mds))return null;
for(var b=0;b<q.els.mds.length;b++)if(q.els.mds[b].Name==a)return q.els.mds[b];return null},zd=function(a){if(a.t==d.Function)return a.rt.o;var b=a.o;if(b==m.Collection){if(a.ct!=H.Value)throw Error("CL71");return a.co}return b},Ed=function(a){wb=!0;if(h(ta)){var b=document.getElementById(ta);h(b)&&(b.className=$rule.trim(b.className.replace("ceCurrent","")))}h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent","")));a.setAttribute("ce207","true");c=a},Oa=function(){if(h(c)){var a=null;c.removeAttribute("ce207");
if("INPUT"==c.tagName){var b=Ba(c),e="";if(b==m.Numeric){if(Ba(c)==m.Numeric){var g=parseInt(c.getAttribute("ce212"),10),l=parseInt(c.getAttribute("ce211"),10),t=parseInt(c.value,10);t<l?(a=q.els.er.e109,c.value=l.toString(),c.setAttribute("ce206",c.value)):t>g&&(a=q.els.er.e108,c.value=g.toString(),c.setAttribute("ce206",c.value))}g=c.getAttribute("ce206");l=parseInt(c.getAttribute("ce211"),10);try{if(h(g)){var x=parseFloat(g.replace(",","."));e=h(x)&&"-0."!=g&&"0."!=g?x.toString():l.toString()}else e=
l.toString()}catch(r){e=l.toString()}}else e=$rule.encode(c.value);x=c;h(ub)?(b=document.getElementById(ub),h(b)&&(c=I(b),c.innerHTML=0==e.length?q.els.lbl.em:e,c.setAttribute("ce206",e),c.setAttribute("ce205",v.Input),c.style.display="",h(a)?(c.className="ceValidationWarning",c.title=a):(c.className="ceValue ceCurrent",c.title=""))):(ca({t:D(x),id:null,v:e,n:0==e.length?q.els.lbl.em:e,st:b,ct:qa(x),ft:U(x),it:v.Input,h:!1,fv:!1}),h(a)&&(c.className="ceValidationWarning",c.title=a));ub=null;C.container.removeChild(x)}}},
gc=function(){var a=[];a.push(G(q.els.cls,"and"));for(var b=$a(),e=!1,g=!1,l=0;l<b.length;l++){if(D(b[l])==d.Flow&&"else"==b[l].getAttribute("ce208")){e=!0;break}b[l].id==c.id&&(g=!0)}if(!g&&e)return a;for(b=0;b<q.els.fls.length;b++)"if"==q.els.fls[b].v||e&&"else"==q.els.fls[b].v||a.push(q.els.fls[b]);return a},Jb=function(a,b){for(var e,g=0;g<a.length;g++)if(e=a[g],e.v==b)return e.n;return null},Ec=function(a){return Jb(q.els.dsc,"ce803"==a?"doesNotExist":"exists")},Va=function(){function a(l){var t=
0,x=0,r;a:{for(r=c;h(r);){if(D(r)==d.RightBracket)break a;r=r.nextSibling}r=null}for(r=r.previousSibling;h(r)&&D(r)!=d.LeftBracket;)qa(r)==u.LeftParenthesis&&t++,qa(r)==u.RightParenthesis&&x++,r=r.previousSibling;t>x&&V(u.RightParenthesis,null,q.els.lbl.pe,l);V(u.Addition,null,"&#43;",l);V(u.Subtraction,null,"&#150;",l);V(u.Multiplication,null,"&#215;",l);V(u.Division,null,"&#247;",l)}var b=[];switch(D(xa(c))){case d.LeftBracket:V(u.LeftParenthesis,null,q.els.lbl.pb,b);V(u.Number,null,qb(m.Numeric),
b);for(var e=fc(),g=0;g<e.length;g++)V(e[g].t==d.Function?u.Function:u.Field,e[g].v,e[g].n,b);break;case d.Value:case d.Calculation:e=qa(c);e==u.None&&(e=qa(xa(c)));switch(e){case u.Number:case u.Field:case u.RightParenthesis:a(b);break;case u.Function:U(c)==n.End&&a(b);break;case u.LeftParenthesis:case u.Addition:case u.Subtraction:case u.Multiplication:case u.Division:for(V(u.LeftParenthesis,null,q.els.lbl.pb,b),V(u.Number,null,qb(m.Numeric),b),e=fc(),g=0;g<e.length;g++)V(e[g].t==d.Function?u.Function:
u.Field,e[g].v,e[g].n,b)}break;default:throw Error("CL80");}return b},Uc=function(a,b){if(!h(a)||0==a.ps.length)return b;var e=lb(c);for(0>e&&(e=0);e<a.ps.length;){if(h(a.ps[e].f))return a.ps[e].f;e++}return b},V=function(a,b,e,g){var l=new p.Menu.Item;l.ID=a;h(b)&&(l.Type=b+"");l.Name=e;g.push(l)},ge=function(a,b){if(a==u.None||b==u.None)throw Error("CL90");switch(a){case u.Field:return b==u.Number||b==u.Field;case u.Number:return b==u.Field||b==u.Number;case u.LeftParenthesis:return b==u.LeftParenthesis;
case u.RightParenthesis:return b==u.RightParenthesis;default:return b==u.Multiplication||b==u.Division||b==u.Addition||b==u.Subtraction}},qd=function(a,b){var e=[];if(!h(a)||0==a.length)return e;b=b.toLowerCase();for(var g,l=0;l<a.length;l++)g=a[l].n||a[l].Name,g.length>=b.length&&g.substr(0,b.length).toLowerCase()==b&&e.push(a[l]);return e},je=function(){if(!h(c))return"i101";if(8==w)return"i126";var a=xa(c);switch(D(a)){case d.Flow:return"else"==a.getAttribute("ce208")?"i110":"i103";case d.LeftSource:case d.LeftParenthesis:return"i103";
case d.RightSource:case d.RightParenthesis:return"i111";case d.Field:if(Da)return"i127";a=G(z.fds,a.getAttribute("ce208"));return h(a)?a.o==m.Collection&&a.ct==H.Reference?"i124":"i104":"i124";case d.Exists:return Da?"i136":"i135";case d.Where:return"i124";case d.LeftBracket:return"i106";case d.RightBracket:return"i121";case d.Calculation:return"i108";case d.Action:switch(U(a)){case n.End:return Pa(a)&&Da?"i128":"else"==Nc(a,d.Flow).getAttribute("ce208")?"i124":"i125";case n.Name:return Da?"i128":
"i123";default:return"i123"}case d.Function:switch(U(a)){case n.End:return Pa(a)&&Da?"i127":"i104";case n.Name:return Da?"i127":"i123";default:return"i123"}case d.Operator:if(Da)return"i129";var b=Ba(a);return b==m.Numeric?(a=Ya(a),a=h(a)?G(z.fds,a.getAttribute("ce208")):null,h(a)&&a.cal?"i122":"i113"):b==m.String?"i113":b==m.Date?"i114":b==m.Time?"i117":"i119";case d.Value:return b=Ba(a),b==m.String||b==m.Numeric?h(a.getAttribute("ce207"))?"i105":"i107":b==m.Date?3==w?"i109":Da?"i132":"i115":b==
m.Time?4==w?"i116":Da?"i133":"i118":Da?"i134":"i120";case d.Clause:return"then"==a.getAttribute("ce208")?"i110":Da?"i129":"i103";default:return"i122"}},qb=function(a,b){switch(a){case m.String:return q.els.lbl.s;case m.Date:return q.els.lbl.v;case m.Time:return q.els.lbl.j;case m.Numeric:return b?q.els.lbl.e:q.els.lbl.m;case m.Bool:return q.els.lbl.b;case m.Enum:return q.els.lbl.e;default:throw Error("CL45");}},ab=function(a){var b=h(a.getAttribute("ce202"))?D(a):null;return b==d.Setter||b==d.Action?
!0:b==d.Flow?!1:h(a.previousSibling)?ab(a.previousSibling):!1},id=function(a,b,e){if(!h(a)||!h(a.ps))return null;for(var g=e;g<=a.ps.length;g++)if(a.ps[g].o==b)return a.ps[g];return 0<e?id(a,b,0):null},Tb=function(a,b){var e=D(a),g=U(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&(e==d.Function||e==d.Action||e==d.Calculation&&(g==n.Name||g==n.End))&&g==b?a:h(a.previousSibling)?Tb(a.previousSibling,b):null},Hc=function(a,b){var e=D(a),g=U(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&
(e==d.Function||e==d.Action||e==d.Calculation&&(g==n.Name||g==n.End))&&g==b?a:h(a.nextSibling)?Hc(a.nextSibling,b):null},Nc=function(a,b){return h(a)?a.getAttribute&&h(a.getAttribute("ce202"))&&D(a)==b?a:h(a.previousSibling)?Nc(a.previousSibling,b):null:null},Ya=function(a){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&(D(a)==d.Field||(D(a)==d.Function||D(a)==d.Action)&&U(a)==n.Name||D(a)==d.Calculation&&U(a)==n.Name)?a:h(a.previousSibling)?Ya(a.previousSibling):null:null},Id=function(a){if(!h(a))return null;
if(h(a.getAttribute)&&h(a.getAttribute("ce202"))){var b=D(a);if(b==d.RightSource||b==d.LeftSource)return a;if(h(a.previousSibling))return Id(a.previousSibling)}return null},mb=function(a,b){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&D(a)==b?a:h(a.nextSibling)?mb(a.nextSibling,b):null:null},jc=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))&&D(a)!=d.HtmlTag?a:h(a.nextSibling)?jc(a.nextSibling):null},xa=function(a){return Wb(a)?a:h(a.previousSibling)?xa(a.previousSibling):
null},Wa=function(a){return Wb(a)?a:h(a.nextSibling)?Wa(a.nextSibling):null},Pb=function(a,b){if(!h(a))return null;var e=U(a);return e==n.End?null:e==n.Param&&Ba(a,!0)==b?a:h(a.nextSibling)?Pb(a.nextSibling,b):null},ad=function(){Z=[];if(h(q.els.lbl.y)){var a=new p.Menu.Item;a.ID="ceEval";a.Name=q.els.lbl.y;Z.push(a)}h(q.els.lbl.x)&&(a=new p.Menu.Item,a.ID="ceExec",a.Name=q.els.lbl.x,Z.push(a));if(h(q.els.rls))for(var b=0;b<q.els.rls.length;b++)a=new p.Menu.Item,a.ID=q.els.rls[b].v||q.els.rls[b].ID,
a.Name=q.els.rls[b].n||q.els.rls[b].Name,Z.push(a)},hb=function(a,b){if(!b){var e=Tb(a,n.Name);ta=e.id;c=I(e)}c=c.nextSibling},aa=function(a){z=null;var b=q.els.src[0].n;h(a)&&(a=Id(a),h(a)&&(b=a.getAttribute("ce208")));for(a=0;a<q.els.src.length;a++)if(q.els.src[a].n==b){z=q.els.src[a];h(z.fds)&&z.fds.length||(z.fds=[]);h(z.acs)&&z.acs.length||(z.acs=[]);if(!h(z.references))for(z.references=!1,a=0;a<z.fds.length;a++)if(b=z.fds[a],b.t==d.Field&&b.o==m.Collection&&b.ct==H.Reference){z.references=!0;
break}break}if(!h(z))throw Error("CL91");},I=function(a){if(h(a)){if(h(ta)){var b=document.getElementById(ta);h(b)&&(b.className=$rule.trim(b.className.replace("ceCurrent","")))}h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent","").replace("ceHighlight","")));"INPUT"!=a.tagName&&0>a.className.indexOf("ceCurrent")&&(a.className+=" ceCurrent");return a}},Pa=function(a){var b=D(a),e=U(a);return b==d.Function||b==d.Action||b==d.Calculation&&(e==n.Name||e==n.End)?(a=Aa(a),h(a)&&h(a.ps)?0==
a.ps.length:!0):!1},Wb=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))?(a=D(a),a!=d.Tab&&a!=d.NewLine&&a!=d.HtmlTag):!1},zb=function(a,b,e,g){return a==d.Value&&(b==m.String||b==m.Numeric)||a==d.Calculation&&e==u.Number||(a==d.Function||a==d.Action)&&g==v.Input&&(b==m.String||b==m.Numeric)},La=function(a){return 31<a&&40>a||41<a&&60>a||61==a||63<a&&91>a||96<a&&123>a||222<a},md=function(){for(var a=$a(),b=0;b<a.length;b++)switch(D(a[b])){case d.Clause:case d.Function:case d.Field:case d.Operator:case d.Value:case d.Action:case d.LeftParenthesis:case d.RightParenthesis:case d.Calculation:return!0}return!1},
va=function(){Cc();Da||Ra();3==w?Ca.position():4==w?ja.position():(6==w||8==w)&&Ta()},ra=function(){if(h(c.nextSibling)){if(q.right){var a=D(c.nextSibling);return a!=d.NewLine&&a!=d.Tab}return!1}return!0},nc=function(){if(h(c.nextSibling))for(c=c.nextSibling;h(c.nextSibling)&&!Wb(c.nextSibling);){var a=c.nextSibling;C.container.removeChild(c);c=a}pb()},cd=function(a){uc&&8<p.Client.version&&window.Modernizr&&3>tc?tc++:(Na=0,1!=w&&2!=w&&va())},be=function(){if(ma){6!=w&&8!=w||Ta();var a=D(c);a!=d.NewLine&&
a!=d.Tab?xb(!1):va()}},Ta=function(){sc=0;y="";P=[];ka.close();w=0},ec=function(a){a=$rule.getChildrenByAttribute(document.body,"class",a);if(h(a)&&0<a.length)for(var b=0,e,g=a.length;b<g;b++)e=a[b],h(e.parentNode)&&e.parentNode.removeChild(e)},fd=function(){C.container.innerHTML="";var a=document.createElement("SPAN");a.className="ceEmpty";a.style.paddingBottom="2px";a.style.display="inline-block";a.style.whiteSpace="nowrap";a.style.cursor="default";a.innerHTML=q.els.lbl.g;C.container.appendChild(a);
c=null},gd=function(){h(C.container)&&(C.container.innerHTML="",C.container.style.color="")},kc=function(a){if(p.getScrollHeight()>a)try{window.scroll(p.getScrollWidth(),a)}catch(b){}},Mc=function(a,b){var e=p.getWindowDimensions().height,g=p.getScrollHeight();if(e+g<a+b)try{window.scroll(p.getScrollWidth(),g+(a+b-(e+g)))}catch(l){}},Qb=function(a){return String(a).replace(/\\/g,"\\\\").replace(/'/g,"'").replace(/"/g,"&quot;")},Zb=function(a){return String(a).replace(/&#92;/g,"\\").replace(/&#39;/g,
"'").replace(/&quot;/g,'"')},yd=function(a){return h(a)?a.replace("+","$"):a},Ba=function(a,b){var e=parseInt(a.getAttribute("ce209"),10);return e!=m.Collection||b?e:G(z.fds,Ya(c).getAttribute("ce208")).co},za=function(a,b){if(h(b)&&0<b.length){var e=p.defined(b)?b:"";a.className=e}},$b=function(a){return"true"==a?q.els.lbl.t:q.els.lbl.f},Ra=function(a,b){if(q.help)if(M.className="ceHelp",h(b)){var e=q.els.ms[a].replace("{0}",b);Kb(e)}else Kb(q.els.ms[h(a)?a:je()])},bb=function(a){return h(a)&&a.getAttribute&&
"if"==a.getAttribute("ce208")},$a=function(){return p.getChildrenByTagName(C.container,"SPAN",!1)},lc=function(a){if(h(c)){var b=c,e=!1;do{"true"==b.getAttribute("ce218")?(b.className=$rule.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218","false")):(b.className=p.trim(b.className)+" ceSelected",b.setAttribute("ce218","true"),e=!0);if(b.id==ia)break;b=a?b.previousSibling:b.nextSibling}while(h(b)&&b.id!=ia);h(b)&&(b.className=$rule.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218",
"false"),e&&(b.className=p.trim(b.className)+" ceSelected",b.setAttribute("ce218","true")))}},D=function(a){return parseInt(a.getAttribute("ce202"),10)},qa=function(a){return parseInt(a.getAttribute("ce203"),10)},U=function(a){return parseInt(a.getAttribute("ce204"),10)},Ua=function(a){return parseInt(a.getAttribute("ce205"),10)},Bb=function(){Ca.hide()},Ab=function(){ja.hide()},Pd=function(a){return jd(a)},Rd=function(a){return Gc(a)},Qd=function(a){return Fc(a)},Kd=function(a){Xd(a)},Kb=function(a){h(M)&&
h(a)&&(M.innerHTML=a)},Sb=function(a){q.help&&(h(a)||(a="--------------"),M.innerHTML=a,h(M)&&(M.className+=" ceValueWarn"))}};